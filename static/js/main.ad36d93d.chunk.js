(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},102:function(e,t,a){},187:function(e,t,a){"use strict";a.r(t);var n,i=a(0),s=a.n(i),r=a(54),o=a.n(r),c=(a(62),a(30)),l=a(17),u=a(1),d=a(16),m=a(15),p=a(14),h=a(24),f=a(22),E=a(23),b=a(3),v=(a(63),a(2));a(97),a(98);function S(e){var t=e.placeholder,a=e.expression,n=e.caretPosition,i=e.onExpression,r=e.onEnter,o=e.onRun,c=e.onReset,l=e.syntaxError,u=(e.strategy,e.onStrategy,e.singleLetterNames,e.onSingleLetterNames,e.isExercise,e.onExercise,e.action,e.onActionClick,e.onActionSelect,a.split("\n").length);return s.a.createElement("div",{className:"editorContainer"},l?s.a.createElement("p",{className:"editorError"},"".concat(l)):null,s.a.createElement("div",{className:"editor"},s.a.createElement(x,{placeholder:t,expression:a,lines:u,caretPosition:n,onChange:function(e){var t=e.target.value,a=e.target.selectionEnd;t=t.replace(/\\/g,"\u03bb"),i(t,a)},onKeyDown:function(e){e.shiftKey||e.ctrlKey||"Enter"!==e.key||(e.preventDefault(),r()),e.ctrlKey&&"Enter"===e.key&&(e.preventDefault(),o()),e.ctrlKey&&"r"===e.key&&(e.preventDefault(),c())}})))}function x(e){var t=e.placeholder,a=e.expression,n=e.lines,i=e.onChange,r=e.onKeyDown,o=e.caretPosition;return s.a.createElement("textarea",{className:"prompt",onKeyDown:r,onChange:i,value:a,placeholder:t,wrap:"hard",autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,rows:Math.max(n,1),ref:function(e){null!==e&&(e.selectionStart=o,e.selectionEnd=o,e.focus())}})}function g(e){return e.trim()}!function(e){e.ENTER_EXPRESSION="Enter Expression",e.ENTER_EXERCISE="Enter Exercise",e.NEXT_STEP="Next Step",e.RUN="Run",e.ENTER_MD="Enter MarkDown"}(n||(n={}));var N={FACT:"(Y (\u03bb f n . (<= n 1) 1 (* n (f (- n 1)))))",FACCT:"(\u03bb n . (Y (\u03bb f n a . IF (= n 1) a (f (- n 1) (* n a)))) (- n 1) (n))",FIB:"(Y (\u03bb f n . (= n 0) 0 ((= n 1) 1 ( + (f (- n 1)) (f (- n 2))))))",APPEND:"Y (\u03bb fn listA listB . IF (NULL listA) (listB) (CONS (FIRST listA) (fn (SECOND listA) listB)))",LISTGREQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (>= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTLESS:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (< (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTGR:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (> (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTEQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",QUICKSORT:"Y (\u03bb fn list . IF (NULL list) (NIL) ( IF (NULL (SECOND list)) (list) ( APPEND (fn (LISTLESS (FIRST list) list)) ( APPEND (LISTEQ (FIRST list) list) (fn (LISTGR (FIRST list) list)) ) ) ) )",INFLIST:"(\u03bb n . (Y (\u03bb x . (\u03bb f s g . g f s) n x)))",REMOVENTH:"Y (\u03bb fn list n . IF (= n 0) (SECOND list) (IF (NULL list) NIL (CONS (FIRST list) (fn (SECOND list) (- n 1) ) ) ) )",NTH:"Y (\u03bb fn list n . IF (= n 0) (FIRST list) (IF (NULL (list)) NIL (fn (SECOND list) (- n 1)) ) )",LEN:"Y (\u03bb fn list . IF (NULL list) (0) (+ 1 (fn (SECOND list) )) )",GETNTH:"(\u03bb end . (Y (\u03bb f n i . (end i) (i) ( (= n 0) (Y (\u03bb f a . (end a) (i) (f) ) ) (f (- n 1)) ) )) )",MAP:"(\u03bb fn l . (Y (\u03bb f it . IF (NULL it) (NIL) (CONS (fn (FIRST it)) (f (SECOND it))) )) l )",REDUCE:"(\u03bb fn l init . Y (\u03bb f it acc . IF (NULL it) (acc) (f (SECOND it) (fn (FIRST it) acc)) ) l init )",APPLY:"(\u03bb f args . Y (\u03bb ff f l . (NULL l) (f) (ff (f (FIRST l)) (SECOND l)) ) f args )",RANGE:"(\u03bb m n . Y (\u03bb f e . (= e n) (CONS e NIL) (CONS e (f (+ e 1))) ) m )",LISTCOMPR:"(\u03bb args . APPLY (\u03bb op in rng cond . Y (\u03bb f l . (NULL l) (NIL) ( (cond (FIRST l)) (CONS (op (FIRST l)) (f (SECOND l))) (CONS (FIRST l) (f (SECOND l))) ) ) rng ) args )",MOD:"(\u03bb n m . (n (\u03bb n . (= n (- m 1)) (0) (+ n 1)) (0)) )",INFIX:"APPLY (\u03bb l op r . op l r)"};function O(){return decodeURI(window.location.hash.substring(1))}a(99),a(100),a(101);var y=a(41),k=y.Switch,R=y.Radio;function L(e){var t=e.__key,a=(e.isActive,e.makeActive,e.isExercise),n=e.makeExercise,i=e.endExercise,r=e.strategy,o=e.onStrategy,c=e.singleLetterNames;return s.a.createElement("div",{id:"controls"},s.a.createElement("div",null,c?s.a.createElement("div",{className:"badge inlineblock"},"Single Letter Names"):null,s.a.createElement(k,{className:"exerciseSwitch",checked:a,onChange:function(e){return e.target.checked?n():i()},shape:"fill"},"Exercise"),s.a.createElement("div",{className:"badge"},s.a.createElement("div",{className:"strategyName inlineblock"},r),s.a.createElement("div",{className:"strategies inlineblock"},s.a.createElement(R,{style:"fill",name:"strategy"+t,checked:r===K.NORMAL,onChange:function(){return o(K.NORMAL)}},"Normal Evaluation"),s.a.createElement(R,{style:"fill",name:"strategy"+t,checked:r===K.APPLICATIVE,onChange:function(){return o(K.APPLICATIVE)}},"Applicative Evaluation")))))}a(102);var j=function(e){function t(e,a,n,i){var s;return Object(m.a)(this,t),(s=Object(h.a)(this,Object(f.a)(t).call(this))).tree=e,s.onClick=a,s.redex=n,s.breakpoints=i,s.rendered=null,s.argument=null,s.tree.visit(Object(b.a)(Object(b.a)(s))),s}return Object(E.a)(t,e),Object(p.a)(t,[{key:"printMultiLambda",value:function(e,t){var a=this;if(e.body instanceof v.Lambda){var n=e.body.argument,i="argument";this.isBreakpoint(e.body.argument)&&(i+=" breakpoint"),this.argument&&this.argument.name()===n.name()&&(i+=" substitutedArg");var r=s.a.createElement("span",{className:"arguments"},t," "," ",s.a.createElement("span",{className:i,onClick:function(){n.identifier=Symbol(),a.onClick({type:v.Beta,context:n,broken:new Set})}},n.name()));this.printMultiLambda(e.body,r)}else{e.body.visit(this);var o=this.rendered;this.rendered=t,this.rendered=s.a.createElement("span",{className:"function"},"(",s.a.createElement("span",{className:"lambda"},"\u03bb "," "),t," . ",o,")")}}},{key:"isBreakpoint",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,s=this.breakpoints[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){if(i.value.context.identifier===e.identifier)return!0}}catch(r){a=!0,n=r}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}return!1}}]),Object(p.a)(t,[{key:"print",value:function(){return this.rendered}},{key:"onApplication",value:function(e){var t="left",a="right",n=!1;if(null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(t+=" redex",a+=" redex",e.left instanceof v.Lambda&&(this.argument=e.left.argument,n=!0)),e.right instanceof v.Application){e.left.visit(this);var i=s.a.createElement("span",{className:t},this.rendered);n&&(this.argument=null),e.right.visit(this);var r=s.a.createElement("span",{className:a},"( ",this.rendered," )");this.rendered=s.a.createElement("span",{className:"application"},i," ",r)}else{e.left.visit(this);var o=s.a.createElement("span",{className:t},this.rendered);n&&(this.argument=null),e.right.visit(this);var c=s.a.createElement("span",{className:a},this.rendered);this.rendered=s.a.createElement("span",{className:"application"},o," ",c)}}},{key:"onLambda",value:function(e){var t=this,a=this.argument;if(this.argument!==e.argument&&null!==this.argument&&this.argument.name()===e.argument.name()&&(this.argument=null),e.body instanceof v.Lambda){var n=e.argument,i="argument";this.isBreakpoint(e.argument)&&(i+=" breakpoint"),this.argument&&this.argument.name()===n.name()&&(i+=" substitutedArg");var r=s.a.createElement("span",{className:i,onClick:function(){n.identifier=Symbol(),t.onClick({type:v.Beta,context:n,broken:new Set})}},e.argument.name());this.printMultiLambda(e,r)}else{var o=e.argument;e.argument.visit(this);var c=this.rendered;e.body.visit(this);var l=this.rendered,u="argument";this.isBreakpoint(e.argument)&&(u+=" breakpoint"),this.rendered=s.a.createElement("span",{className:"function"},"(",s.a.createElement("span",{className:"lambda"},"\u03bb "," "),s.a.createElement("span",{className:u,onClick:function(){o.identifier=Symbol(),t.onClick({type:v.Beta,context:o,broken:new Set})}},c," "," "),". ",l,")")}null!==a&&(this.argument=a)}},{key:"onChurchNumeral",value:function(e){var t=this,a="churchnumeral";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=s.a.createElement("span",{className:a,onClick:function(){e.identifier=Symbol(),t.onClick({type:v.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onMacro",value:function(e){var t=this,a="macro";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=s.a.createElement("span",{className:a,onClick:function(){e.identifier=Symbol(),t.onClick({type:v.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onVariable",value:function(e){var t="variable";this.argument&&this.argument.name()===e.name()&&(t+=" substitutedArg"),this.rendered=s.a.createElement("span",{className:t},e.name())}}]),t}(v.ASTVisitor),I=a(29);function C(e){var t=e.lastReduction;return null===t?null:t instanceof v.Beta?s.a.createElement("p",{className:"lastReduction"},"\u03b2 reduction"):t instanceof v.Alpha?s.a.createElement("p",{className:"lastReduction"},"\u03b1 conversion"):t instanceof v.Expansion?s.a.createElement("p",{className:"lastReduction"},"Macro expansion"):t instanceof I.Eta?s.a.createElement("p",{className:"lastReduction"},"\u03b7 conversion"):null}function w(e){var t=e.stepRecord,a=e.addBreakpoint,n=e.breakpoints,i=e.children,r=e.strategy,o=t.ast,c=t.lastReduction,l=t.step;t.message;if(null===o)return null;var u=null,d=new(Q(r))(o);d.nextReduction instanceof v.Beta&&(u=d.nextReduction.redex),d.nextReduction instanceof v.Expansion&&(u=d.nextReduction.target);var m=new j(o,a,u,n);return s.a.createElement("span",{className:"step"},s.a.createElement(C,{lastReduction:c}),s.a.createElement("div",{className:"inlineblock"},s.a.createElement("p",{className:"stepNumber"},l," :"),m.print(),i,""===t.message?null:s.a.createElement("p",{className:"stepMessage"},t.message)))}var T=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).addBreakpoint=a.addBreakpoint.bind(Object(b.a)(Object(b.a)(a))),a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.state,n=t.updateState,i=t.isActive,r=(t.editor,a.__key),o=a.history,c=a.isRunning,l=a.breakpoints,u=a.isExercise,d=a.strategy,m=a.singleLetterNames,p=(o[o.length-1],"box boxEval");return u&&(p+=" boxExercise"),i?s.a.createElement("div",{className:p},s.a.createElement("ul",{className:"UL"},function(e,t,a,n){for(var i=new Array(t-e+1),s=0,r=e;r<=t;++r)i[s++]=n(a[r],r);return i}(0,o.length-2,o,function(t,n){return s.a.createElement("li",{key:n,className:"inactiveStep LI"},s.a.createElement(w,{breakpoints:l,addBreakpoint:function(){},stepRecord:t,strategy:d},s.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(t.ast,a.strategy,m)}})))}),s.a.createElement("li",{key:o.length-1,className:"activeStep LI"},s.a.createElement(w,{breakpoints:l,addBreakpoint:this.addBreakpoint,stepRecord:o[o.length-1],strategy:d},s.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(o[o.length-1].ast,a.strategy,m)}})))),s.a.createElement(L,{isRunning:c,isActive:this.props.isActive,makeActive:this.props.makeActive,isExercise:u,makeExercise:function(){return e.props.updateState({isExercise:!0})},endExercise:function(){return e.props.updateState({isExercise:!1})},strategy:d,onStrategy:function(e){return n({strategy:e})},__key:r,singleLetterNames:m})):s.a.createElement("div",{className:p+" inactiveBox",onDoubleClick:this.props.makeActive},s.a.createElement("ul",{className:"UL"},s.a.createElement("li",{key:0,className:"activeStep LI"},s.a.createElement(w,{breakpoints:l,addBreakpoint:function(){},stepRecord:o[0],strategy:d},s.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(o[0].ast,a.strategy,m)}})))),s.a.createElement("p",{className:"inactiveMessage"},"Collapsing ",o.length-1," steps. Double click to activate this box."))}},{key:"addBreakpoint",value:function(e){var t=this.props,a=t.state;(0,t.updateState)({breakpoints:[].concat(Object(l.a)(a.breakpoints),[e])})}}]),t}(i.PureComponent);function A(e){var t=e.state,a=t.macroName,n=t.macroExpression;return s.a.createElement("div",{className:"box boxMacro"},a," := ",n)}a(186);var D,M=a(103);function F(e){var t=e.state.note;return s.a.createElement("div",{className:"box boxNote markdown-body"},s.a.createElement(M,{source:t}))}function B(e){var t=e.state,a=e.updateState,n=e.isActive,i=t.type;return i===D.expression?s.a.createElement("div",{className:""},s.a.createElement(T,{state:t,updateState:a,editExpression:e.editExpression,isActive:n,makeActive:e.makeActive,editor:e.editor})):i===D.macro?s.a.createElement("div",{className:""},s.a.createElement(A,{state:t})):i===D.note?s.a.createElement("div",{className:""},s.a.createElement(F,{state:t})):s.a.createElement("div",null,"I do not know what to do with this yet.")}function U(e){var t=e.state,a=e.onImport,n=e.onScreenChange,i=t.screen,r=function(e){return Object(u.a)({},e,{submittedExpressions:e.submittedExpressions.map(P)})}(t),o=function(e){var t=new Blob([e],{type:"application/json"});return window.URL.createObjectURL(t)}(JSON.stringify(r));return s.a.createElement("div",{id:"topbar"},s.a.createElement("div",null,s.a.createElement("i",{id:"notebooks",className:"icon fas fa-book-open fa-2x"}),s.a.createElement("p",{className:"iconLabel"},"Notebooks")),s.a.createElement("div",null,i===V.main?s.a.createElement("i",{className:"icon fas fa-list-ul fa-2x",onClick:function(){return n(V.macrolist)}}):s.a.createElement("i",{className:"icon far fa-window-close fa-2x",onClick:function(){return n(V.main)}}),s.a.createElement("p",{className:"iconLabel"},"Macros")),s.a.createElement("div",null,s.a.createElement("a",{className:"export",href:o,download:"notebook_lambdulus.json",onClick:function(){return setTimeout(function(){return window.URL.revokeObjectURL(o)},10)}},s.a.createElement("i",{id:"download",className:"icon fas fa-cloud-download-alt fa-2x"})),s.a.createElement("p",{className:"iconLabel"},"Export")),s.a.createElement("div",null,s.a.createElement("input",{type:"file",accept:"application/json",id:"input",onChange:function(e){return function(e,t){var a=e.target.files;if(null===a)return;var n=a[0],i=new FileReader;i.onload=function(e){var a=JSON.parse(i.result);t(function(e){var t=e.macroTable;return Object(u.a)({},e,{submittedExpressions:e.submittedExpressions.map(function(e){return function(e,t){if(e.type===D.expression){var a=e,n=a.singleLetterNames,i=function(e,t){var a=t.singleLetterNames,n=t.macroTable,i=Object(v.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(v.parse)(i,n)}(e.expression,{macroTable:t,singleLetterNames:n});return Object(u.a)({},e,{ast:i,history:[{ast:i,lastReduction:v.None,step:0,message:"",isNormalForm:!1}]})}return e}(e,t)})})}(a))},i.readAsText(n)}(e,a)}}),s.a.createElement("label",{htmlFor:"input"},s.a.createElement("i",{className:"icon fas fa-cloud-upload-alt fa-2x"})),s.a.createElement("p",{className:"iconLabel"},"Import")))}function P(e){return e.type===D.expression?Object(u.a)({},e,{ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0}):e}function _(e){var t=e.submittedExpressions,a=e.updateState,n=e.removeExpression,i=e.activeBox,r=e.makeActive;return s.a.createElement("div",{className:"evaluatorSpace"},t.length?s.a.createElement("ul",{className:"evaluatorList UL"},t.map(function(t,o){return s.a.createElement("li",{className:"LI",key:t.__key},s.a.createElement(B,{state:t,updateState:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return a(e,o)}),removeExpression:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return n(o)}),editExpression:e.editExpression,isActive:o===i,makeActive:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return r(o)}),editor:e.editor}))})):null)}function Y(e){var t=e.macroTable,a=e.removeMacro;return s.a.createElement("div",{className:"macroSpace"},s.a.createElement("p",null,"Built-in Macros"),s.a.createElement("ul",{className:"UL"},Object.entries(v.builtinMacros).map(function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return s.a.createElement("div",{key:a},s.a.createElement("li",{className:"LI"},s.a.createElement("div",{className:"box boxMacro"},a," := ",n)))})),s.a.createElement("p",null,"User-defined Macros"),s.a.createElement("ul",null,Object.entries(t).map(function(e){var t=Object(d.a)(e,2),n=t[0],i=t[1];return s.a.createElement("div",{key:n},s.a.createElement("li",{className:"LI"},s.a.createElement("div",{className:"box boxMacro"},n," := ",i,s.a.createElement("i",{className:"hiddenMacroIcon far fa-trash-alt",onClick:function(){return a(n)}}))))})))}!function(e){e[e.expression=0]="expression",e[e.macro=1]="macro",e[e.note=2]="note"}(D||(D={}));var V,X,K,q=a(55),G=function(){function e(t){Object(m.a)(this,e),this.roots=t,this.translator=new Map,this.equals=!0,this.context=void 0;var a=t,n=Object(q.a)(a);this.context=n.slice(0),this.compare()}return Object(p.a)(e,[{key:"compare",value:function(){var e=Object(d.a)(this.context,2),t=e[0],a=e[1];if(t instanceof v.Lambda&&a instanceof v.Lambda){var n=new Map(this.translator.entries());this.translator.set(t.argument.name(),a.argument.name()),this.context=[t.right,a.right],this.compare(),this.translator=n}else if(t instanceof v.Application&&a instanceof v.Application){if(this.context=[t.left,a.left],this.compare(),!this.equals)return;this.context=[t.right,a.right],this.compare()}else t instanceof v.Macro&&a instanceof v.Macro?this.equals=t.name()===a.name():t instanceof v.ChurchNumeral&&a instanceof v.ChurchNumeral?this.equals=t.name()===a.name():t instanceof v.Variable&&a instanceof v.Variable?this.equals=this.translator.get(t.name())===a.name():this.equals=!1}}]),e}(),J=a(41),z=J.Switch,H=J.Radio;J.Checkbox;function Q(e){switch(e){case K.NORMAL:return v.NormalEvaluator;case K.APPLICATIVE:return v.ApplicativeEvaluator;case K.OPTIMISATION:return v.OptimizeEvaluator}}!function(e){e[e.main=0]="main",e[e.macrolist=1]="macrolist",e[e.notebooks=2]="notebooks"}(V||(V={})),function(e){e.INIT="type \u03bb expression",e.EVAL_MODE="HIT ENTER AGAIN FOR NEXT STEP",e.VALIDATE_MODE="write next step and hit enter for validation"}(X||(X={})),function(e){e.NORMAL="Normal Evaluation",e.APPLICATIVE="Applicative Evaluation",e.OPTIMISATION="Optimisation - \u03b7 Conversion "}(K||(K={}));var W=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).parseExpression=a.parseExpression.bind(Object(b.a)(Object(b.a)(a))),a.updateFromURL=a.updateFromURL.bind(Object(b.a)(Object(b.a)(a)));var i=function(e,t){var a;return[function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];window.clearTimeout(a),a=window.setTimeout(function(){e.apply(void 0,i)},t)},function(){window.clearTimeout(a)}]}(a.updateURL.bind(Object(b.a)(Object(b.a)(a))),500),s=Object(d.a)(i,2),r=s[0],o=s[1];a.updateURL=r,a.cancelUpdate=o,a.onExpression=a.onExpression.bind(Object(b.a)(Object(b.a)(a))),a.onSubmit=a.onSubmit.bind(Object(b.a)(Object(b.a)(a))),a.onRemoveExpression=a.onRemoveExpression.bind(Object(b.a)(Object(b.a)(a))),a.updateMacros=a.updateMacros.bind(Object(b.a)(Object(b.a)(a))),a.onUpdateEvaluationState=a.onUpdateEvaluationState.bind(Object(b.a)(Object(b.a)(a))),a.onRemoveMacro=a.onRemoveMacro.bind(Object(b.a)(Object(b.a)(a))),a.onEnter=a.onEnter.bind(Object(b.a)(Object(b.a)(a))),a.onStep=a.onStep.bind(Object(b.a)(Object(b.a)(a))),a.onRemoveLastStep=a.onRemoveLastStep.bind(Object(b.a)(Object(b.a)(a))),a.onExerciseStep=a.onExerciseStep.bind(Object(b.a)(Object(b.a)(a))),a.onRun=a.onRun.bind(Object(b.a)(Object(b.a)(a))),a._onRun=a._onRun.bind(Object(b.a)(Object(b.a)(a))),a.__onRun=a.__onRun.bind(Object(b.a)(Object(b.a)(a))),a.onStop=a.onStop.bind(Object(b.a)(Object(b.a)(a))),a.onClear=a.onClear.bind(Object(b.a)(Object(b.a)(a))),a.shouldBreak=a.shouldBreak.bind(Object(b.a)(Object(b.a)(a))),a.isNote=a.isNote.bind(Object(b.a)(Object(b.a)(a))),a.onRun=a.onRun.bind(Object(b.a)(Object(b.a)(a))),window.addEventListener("hashchange",a.updateFromURL);var c=O();return a.state={editorState:{placeholder:X.INIT,expression:c,caretPosition:c.length,syntaxError:null,strategy:K.NORMAL,singleLetterNames:!1,isExercise:!1,action:n.ENTER_EXPRESSION,isMarkDown:!1},macroTable:Object(u.a)({},N,JSON.parse(window.localStorage.getItem("macrotable")||"{}")),submittedExpressions:[],screen:V.main,activeBox:-1},a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.editorState,i=a.expression,r=a.caretPosition,o=a.syntaxError,c=a.placeholder,l=a.isExercise,d=t.macroTable,m=t.submittedExpressions,p=t.screen,h=t.activeBox;void 0!==m[h]&&m[h].type===D.expression&&m[h].isExercise;var f=function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{strategy:t})}))},E=function(){return s.a.createElement(S,{placeholder:c,expression:i,caretPosition:r,onExpression:e.onExpression,onEnter:e.onEnter,syntaxError:o,onRun:e.onRun,onReset:e.onClear,strategy:e.state.editorState.strategy,onStrategy:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{strategy:t})}))},singleLetterNames:e.state.editorState.singleLetterNames,onSingleLetterNames:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{singleLetterNames:t})}))},isExercise:l,onExercise:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{isExercise:t})}))},action:e.state.editorState.action,onActionSelect:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{action:t})}))},onActionClick:function(){var t=e.state.editorState.action;t!==n.ENTER_EXPRESSION?t!==n.NEXT_STEP?t!==n.RUN&&t===n.ENTER_EXERCISE&&e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{isExercise:!0})}),function(){return e.onEnter()}):e.onStep():e.onEnter()}})},b=s.a.createElement("div",null,"Notebooks are not implemented yet.");return s.a.createElement("div",{className:"app"},s.a.createElement(U,{state:this.state,onImport:function(t){return e.setState(t)},onScreenChange:function(t){return e.setState(Object(u.a)({},e.state,{screen:t}))}}),s.a.createElement("div",{className:"editorSettings"},s.a.createElement("div",{className:"strategies"},s.a.createElement("p",{className:"stratsLabel inlineblock"},"Evaluation Strategies:"),s.a.createElement(H,{style:"fill",name:"strategy",checked:this.state.editorState.strategy===K.NORMAL,onChange:function(){return f(K.NORMAL)}},"Normal"),s.a.createElement(H,{style:"fill",name:"strategy",checked:this.state.editorState.strategy===K.APPLICATIVE,onChange:function(){return f(K.APPLICATIVE)}},"Applicative")),s.a.createElement(z,{checked:this.state.editorState.singleLetterNames,onChange:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{singleLetterNames:t.target.checked})}))},disabled:this.state.editorState.isMarkDown,shape:"fill"},"Single Letter Names"),s.a.createElement(z,{checked:l,onChange:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{isExercise:t.target.checked})}))},disabled:this.state.editorState.isMarkDown,shape:"fill"},"Exercise Mode"),s.a.createElement(z,{checked:this.state.editorState.isMarkDown,onChange:function(t){return e.setState(Object(u.a)({},e.state,{editorState:Object(u.a)({},e.state.editorState,{isMarkDown:t.target.checked})}))},shape:"fill"},"MarkDown Mode")),p===V.main?s.a.createElement(_,{removeExpression:e.onRemoveExpression,updateState:e.onUpdateEvaluationState,submittedExpressions:m,editExpression:function(t,a,n){return e.setState(Object(u.a)({},e.state,{editorState:{placeholder:X.INIT,expression:t.toString(),caretPosition:t.toString().length,syntaxError:null,strategy:a,singleLetterNames:n,isExercise:!1,action:e.state.editorState.action,isMarkDown:e.state.editorState.isMarkDown}}))},activeBox:h,makeActive:function(t){return e.setState(Object(u.a)({},e.state,{activeBox:t}))},editor:E()}):p===V.macrolist?s.a.createElement(Y,{macroTable:d,removeMacro:e.onRemoveMacro}):b,E())}},{key:"updateURL",value:function(e){history.pushState({},"page title?","#"+encodeURI(e))}},{key:"cancelUpdate",value:function(){}},{key:"onExpression",value:function(e,t){this.setState(Object(u.a)({},this.state,{editorState:Object(u.a)({},this.state.editorState,{placeholder:this.state.editorState.placeholder,expression:e,caretPosition:t,syntaxError:null})})),this.updateURL(e)}},{key:"onUpdateEvaluationState",value:function(e,t){var a=this.state.submittedExpressions;a[t]=Object(u.a)({},a[t],e),this.setState(Object(u.a)({},this.state,{submittedExpressions:a}))}},{key:"onRemoveExpression",value:function(){}},{key:"onRemoveLastStep",value:function(){console.log("CURRENTLY NOT IMPEMENTED")}},{key:"onRun",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox];void 0!==t&&(t.type===D.expression&&(!1===t.isRunning?this._onRun():this.onStop()))}},{key:"onUpdateBoxState",value:function(e){var t=this.state,a=t.submittedExpressions;a[t.activeBox]=e,this.setState(Object(u.a)({},this.state,{submittedExpressions:a}))}},{key:"_onRun",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox],a=t.timeout,n=t.history,i=n[n.length-1];if(!i.isNormalForm){var s=i.ast,r=i.step,o=i.lastReduction,c=i.isNormalForm;i.message;n.push(n[n.length-1]),n[n.length-2]={ast:s.clone(),step:r,lastReduction:o,message:"Skipping some steps...",isNormalForm:c},this.onUpdateBoxState(Object(u.a)({},t,{history:n,isRunning:!0,timeoutID:window.setTimeout(this.__onRun,a)}))}}},{key:"__onRun",value:function(){var e=this,t=this.state,a=t.submittedExpressions[t.activeBox],n=a.history,i=a.isRunning,s=a.breakpoints,r=a.timeoutID,o=a.timeout,c=a.strategy,l=n[n.length-1],d=l.isNormalForm,m=l.step,p=l.lastReduction;if(i)if(d)this.onUpdateBoxState(Object(u.a)({},a,{isRunning:!1,timeoutID:void 0}));else{var h=n[n.length-1].ast,f=new(Q(c))(h);if(p=f.nextReduction,f.nextReduction instanceof v.None)return n.pop(),n.push({ast:h,lastReduction:l.lastReduction,step:m,message:"Expression is in normal form.",isNormalForm:!0}),void this.onUpdateBoxState(Object(u.a)({},a,{history:n,isRunning:!1,timeoutID:void 0}));var E=s.find(function(t){return e.shouldBreak(t,f.nextReduction)});if(void 0!==E)return f.nextReduction instanceof v.Expansion&&E.broken.add(f.nextReduction.target),f.nextReduction instanceof v.Beta&&f.nextReduction.redex.left instanceof v.Lambda&&E.broken.add(f.nextReduction.redex.left.argument),window.clearTimeout(r),void this.onUpdateBoxState(Object(u.a)({},a,{isRunning:!1,breakpoints:s,timeoutID:void 0}));h=f.perform(),n[n.length-1]={ast:h,lastReduction:p,step:m+1,message:"",isNormalForm:d},this.onUpdateBoxState(Object(u.a)({},a,{history:n,timeoutID:window.setTimeout(this.__onRun,o)}))}}},{key:"onStop",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox],a=t.timeoutID;window.clearTimeout(a),this.onUpdateBoxState(Object(u.a)({},t,{isRunning:!1,timeoutID:void 0}))}},{key:"shouldBreak",value:function(e,t){return t instanceof e.type&&t instanceof v.Beta&&e.context instanceof v.Variable&&t.redex.left instanceof v.Lambda&&t.redex.left.argument.identifier===e.context.identifier&&!e.broken.has(t.redex.left.argument)||(t instanceof e.type&&t instanceof v.Expansion&&e.context instanceof v.ChurchNumeral&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)||t instanceof e.type&&t instanceof v.Expansion&&e.context instanceof v.Macro&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target))}},{key:"onClear",value:function(){var e=this.state,t=e.submittedExpressions,a=e.activeBox;if(void 0!==t[a]&&t[a].type===D.expression){var n=t[a];this.onUpdateBoxState(Object(u.a)({},n,{history:[{ast:n.ast.clone(),lastReduction:v.None,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[]}))}}},{key:"onEnter",value:function(){var e=this.state,t=e.editorState.expression,a=e.submittedExpressions[e.activeBox];void 0!==a&&a.isExercise?this.onExerciseStep():t.length||void 0===a||a.type!==D.expression?this.onSubmit():this.onStep()}},{key:"onExerciseStep",value:function(){var e=this.state.editorState.expression;try{var t=this.parseExpression(e),a=this.state,n=a.submittedExpressions,i=a.activeBox,s=n[i],r=s.history,o=s.strategy,c=r[r.length-1],d=c.isNormalForm,m=c.step,p=c.ast,h=c.lastReduction;if(p=p.clone(),d)return c.message="No more steps available. Expression is in normal form.",void this.setState(Object(u.a)({},this.state,{submittedExpressions:n}));var f=new(Q(o))(p);if(h=f.nextReduction,f.nextReduction instanceof v.None)return c.isNormalForm=!0,c.message="Expression is already in normal form.",n[i]=Object(u.a)({},s,{history:r}),void this.setState(Object(u.a)({},this.state,{submittedExpressions:n}));p=f.perform();var E="";new G([t,p]).equals?(p=t,E="Correct."):(console.log("Incorrect step"),E="Incorrect step. ".concat(e)),n[i]=Object(u.a)({},s,{history:[].concat(Object(l.a)(r),[{ast:p,lastReduction:h,step:m+1,message:E,isNormalForm:!1}])}),this.setState(Object(u.a)({},this.state,{editorState:Object(u.a)({},this.state.editorState,{expression:"",caretPosition:0,placeholder:X.VALIDATE_MODE,syntaxError:null}),submittedExpressions:n}))}catch(b){this.onSubmit()}}},{key:"onStep",value:function(){var e=this.state,t=e.submittedExpressions,a=e.activeBox,n=t[a],i=n.history,s=n.strategy,r=i[i.length-1],o=r.isNormalForm,c=r.step,d=r.ast,m=r.lastReduction;if(d=d.clone(),!o){var p=new(Q(s))(d);if(m=p.nextReduction,p.nextReduction instanceof v.None)return r.isNormalForm=!0,r.message="Expression is in normal form.",t[a]=Object(u.a)({},n,{history:i}),void this.setState(Object(u.a)({},this.state,{submittedExpressions:t}));d=p.perform(),t[a]=Object(u.a)({},n,{history:[].concat(Object(l.a)(i),[{ast:d,lastReduction:m,step:c+1,message:"",isNormalForm:!1}])}),this.setState(Object(u.a)({},this.state,{submittedExpressions:t}))}}},{key:"onSubmit",value:function(){this.cancelUpdate();var e=this.state,t=e.editorState,a=t.expression,n=t.caretPosition,i=e.submittedExpressions,s=e.macroTable;e.activeBox;if(history.pushState({},"","#"+encodeURI(a)),function(e){try{return e.indexOf(":=")>0}catch(t){return!1}}(a)){history.pushState({},"","#"+encodeURI(""));var r=a.split(":=").map(g),o=Object(d.a)(r,2),m=o[0],p=o[1],h={type:D.macro,__key:Date.now().toString(),macroName:m,macroExpression:p},f=Object(u.a)({},s,Object(c.a)({},m,p));this.setState(Object(u.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise,action:this.state.editorState.action,isMarkDown:this.state.editorState.isMarkDown},submittedExpressions:[].concat(Object(l.a)(i),[h]),macroTable:f,activeBox:i.length})),this.updateMacros(f)}else if(this.isNote(a)){history.pushState({},"","#"+encodeURI(""));var E={type:D.note,__key:Date.now().toString(),note:a};this.setState(Object(u.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise,action:this.state.editorState.action,isMarkDown:this.state.editorState.isMarkDown},submittedExpressions:[].concat(Object(l.a)(i),[E]),activeBox:i.length}))}else try{var b=this.parseExpression(a);history.pushState({},"","#"+encodeURI(""));var S={type:D.expression,__key:Date.now().toString(),expression:a,ast:b,history:[{ast:b.clone(),lastReduction:v.None,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:this.state.editorState.isExercise,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames};this.setState(Object(u.a)({},this.state,{editorState:{placeholder:X.EVAL_MODE,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise,action:this.state.editorState.action,isMarkDown:this.state.editorState.isMarkDown},submittedExpressions:[].concat(Object(l.a)(i),[S]),activeBox:i.length}))}catch(x){this.updateURL(a),console.log(x),this.setState(Object(u.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:a,caretPosition:n,syntaxError:x,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise,action:this.state.editorState.action,isMarkDown:this.state.editorState.isMarkDown}}))}}},{key:"updateFromURL",value:function(){var e=this.state.editorState.expression,t=O();e!==t?this.setState(Object(u.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:t,caretPosition:t.length,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise,action:this.state.editorState.action,isMarkDown:this.state.editorState.isMarkDown}})):console.log("ALREADY SYNCED")}},{key:"parseExpression",value:function(e){var t=this.state.macroTable,a=this.state.editorState.singleLetterNames,n=Object(v.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(v.parse)(n,t)}},{key:"onRemoveMacro",value:function(e){var t=this.state.macroTable,a=Object(u.a)({},t);delete a[e],this.setState(Object(u.a)({},this.state,{macroTable:a})),this.updateMacros(a)}},{key:"updateMacros",value:function(e){window.localStorage.setItem("macrotable",JSON.stringify(e))}},{key:"isNote",value:function(e){return this.state.editorState.isMarkDown}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},56:function(e,t,a){e.exports=a(187)},62:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){}},[[56,1,2]]]);
//# sourceMappingURL=main.ad36d93d.chunk.js.map