(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{38:function(e,t,a){e.exports=a(85)},44:function(e,t,a){},78:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(36),r=a.n(s),o=(a(44),a(25)),c=a(15),l=a(3),u=a(14),m=a(13),d=a(12),p=a(21),h=a(19),f=a(20),E=a(2),b=a(1),v=(a(78),a(79),a(80),a(35)),x=v.Switch,g=v.Radio;function S(e){var t=e.placeholder,a=e.expression,n=e.caretPosition,s=e.onExpression,r=e.onEnter,o=e.onRun,c=e.onReset,l=e.syntaxError,u=e.strategy,m=e.onStrategy,d=e.singleLetterNames,p=e.onSingleLetterNames,h=e.isExercise,f=e.onExercise,E=a.split("\n").length;return i.a.createElement("div",{className:"editorContainer"},i.a.createElement("p",{className:"badge"},"ENTER for STEP"),i.a.createElement("p",{className:"badge"},"CTRL + ENTER for RUN"),i.a.createElement("p",{className:"badge"},"CTRL + R for RESET"),i.a.createElement("div",{className:"editorSettings"},i.a.createElement(x,{checked:d,onChange:function(e){return p(e.target.checked)},shape:"slim"},"single letter names"),i.a.createElement(x,{checked:h,onChange:function(e){return f(e.target.checked)},shape:"slim"},"exercise"),i.a.createElement("div",{className:"strategies inlineblock"},i.a.createElement(g,{name:"strategy",checked:u===q.NORMAL,onChange:function(){return m(q.NORMAL)}},"Normal Evaluation"),i.a.createElement(g,{name:"strategy",checked:u===q.APPLICATIVE,onChange:function(){return m(q.APPLICATIVE)}},"Applicative Evaluation"),i.a.createElement(g,{name:"strategy",checked:u===q.OPTIMISATION,onChange:function(){return m(q.OPTIMISATION)}},"Optimisation"))),i.a.createElement("p",null,l?"".concat(l):null),i.a.createElement("div",{className:"editor"},i.a.createElement(N,{placeholder:t,expression:a,lines:E,caretPosition:n,onChange:function(e){var t=e.target.value,a=e.target.selectionEnd;t=t.replace(/\\/g,"\u03bb"),s(t,a)},onKeyDown:function(e){e.shiftKey||e.ctrlKey||"Enter"!==e.key||(e.preventDefault(),r()),e.ctrlKey&&"Enter"===e.key&&(e.preventDefault(),o()),e.ctrlKey&&"r"===e.key&&(e.preventDefault(),c())}})))}function N(e){var t=e.placeholder,a=e.expression,n=e.lines,s=e.onChange,r=e.onKeyDown,o=e.caretPosition;return i.a.createElement("textarea",{className:"prompt",onKeyDown:r,onChange:s,value:a,placeholder:t,wrap:"hard",autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,rows:Math.max(n,1),ref:function(e){null!==e&&(e.selectionStart=o,e.selectionEnd=o,e.focus())}})}function O(e){return e.trim()}var y={FACT:"(Y (\u03bb f n . (<= n 1) 1 (* n (f (- n 1)))))",FACCT:"(\u03bb n . (Y (\u03bb f n a . IF (= n 1) a (f (- n 1) (* n a)))) (- n 1) (n))",FIB:"(Y (\u03bb f n . (= n 0) 0 ((= n 1) 1 ( + (f (- n 1)) (f (- n 2))))))",APPEND:"Y (\u03bb fn listA listB . IF (NULL listA) (listB) (CONS (FIRST listA) (fn (SECOND listA) listB)))",LISTGREQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (>= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTLESS:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (< (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTGR:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (> (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTEQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",QUICKSORT:"Y (\u03bb fn list . IF (NULL list) (NIL) ( IF (NULL (SECOND list)) (list) ( APPEND (fn (LISTLESS (FIRST list) list)) ( APPEND (LISTEQ (FIRST list) list) (fn (LISTGR (FIRST list) list)) ) ) ) )",INFLIST:"(\u03bb n . (Y (\u03bb x . (\u03bb f s g . g f s) n x)))",REMOVENTH:"Y (\u03bb fn list n . IF (= n 0) (SECOND list) (IF (NULL list) NIL (CONS (FIRST list) (fn (SECOND list) (- n 1) ) ) ) )",NTH:"Y (\u03bb fn list n . IF (= n 0) (FIRST list) (IF (NULL (list)) NIL (fn (SECOND list) (- n 1)) ) )",LEN:"Y (\u03bb fn list . IF (NULL list) (0) (+ 1 (fn (SECOND list) )) )",GETNTH:"(\u03bb end . (Y (\u03bb f n i . (end i) (i) ( (= n 0) (Y (\u03bb f a . (end a) (i) (f) ) ) (f (- n 1)) ) )) )",MAP:"(\u03bb fn l . (Y (\u03bb f it . IF (NULL it) (NIL) (CONS (fn (FIRST it)) (f (SECOND it))) )) l )",REDUCE:"(\u03bb fn l init . Y (\u03bb f it acc . IF (NULL it) (acc) (f (SECOND it) (fn (FIRST it) acc)) ) l init )",APPLY:"(\u03bb f args . Y (\u03bb ff f l . (NULL l) (f) (ff (f (FIRST l)) (SECOND l)) ) f args )",RANGE:"(\u03bb m n . Y (\u03bb f e . (= e n) (CONS e NIL) (CONS e (f (+ e 1))) ) m )",LISTCOMPR:"(\u03bb args . APPLY (\u03bb op in rng cond . Y (\u03bb f l . (NULL l) (NIL) ( (cond (FIRST l)) (CONS (op (FIRST l)) (f (SECOND l))) (CONS (FIRST l) (f (SECOND l))) ) ) rng ) args )",MOD:"(\u03bb n m . (n (\u03bb n . (= n (- m 1)) (0) (+ n 1)) (0)) )",INFIX:"APPLY (\u03bb l op r . op l r)"};function k(){return decodeURI(window.location.hash.substring(1))}a(81),a(82),a(83);var R=a(35),L=(R.Switch,R.Radio);function I(e){var t=e.__key,a=e.isActive,n=e.makeActive,s=e.isExercise,r=e.makeExercise,o=e.endExercise,c=e.strategy,l=e.onStrategy,u=e.singleLetterNames;return i.a.createElement("div",{id:"controls"},a?i.a.createElement("div",{className:"badge"},"active"):i.a.createElement("div",{className:"badge makeBadge",onClick:n},"make active"),s?i.a.createElement("div",{className:"badge makeBadge",onClick:o},"end exercise"):i.a.createElement("div",{className:"badge makeBadge",onClick:r},"make exercise"),u?i.a.createElement("div",{className:"badge"},"single letter names enabled"):null,i.a.createElement("div",{className:"badge"},i.a.createElement("div",{className:"strategyName inlineblock"},c),i.a.createElement("div",{className:"strategies inlineblock"},i.a.createElement(L,{name:"strategy"+t,checked:c===q.NORMAL,onChange:function(){return l(q.NORMAL)}},"Normal Evaluation"),i.a.createElement(L,{name:"strategy"+t,checked:c===q.APPLICATIVE,onChange:function(){return l(q.APPLICATIVE)}},"Applicative Evaluation"),i.a.createElement(L,{name:"strategy"+t,checked:c===q.OPTIMISATION,onChange:function(){return l(q.OPTIMISATION)}},"Optimisation"))))}a(84);var j=function(e){function t(e,a,n,i){var s;return Object(m.a)(this,t),(s=Object(p.a)(this,Object(h.a)(t).call(this))).tree=e,s.onClick=a,s.redex=n,s.breakpoints=i,s.rendered=null,s.argument=null,s.tree.visit(Object(E.a)(Object(E.a)(s))),s}return Object(f.a)(t,e),Object(d.a)(t,[{key:"printMultiLambda",value:function(e,t){var a=this;if(e.body instanceof b.Lambda){var n=e.body.argument,s="argument";this.isBreakpoint(e.body.argument)&&(s+=" breakpoint"),this.argument&&this.argument.name()===n.name()&&(s+=" substitutedArg");var r=i.a.createElement("span",{className:"arguments"},t," "," ",i.a.createElement("span",{className:s,onClick:function(){return a.onClick({type:b.Beta,context:n,broken:new Set})}},n.name()));this.printMultiLambda(e.body,r)}else{e.body.visit(this);var o=this.rendered;this.rendered=t,this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda",onClick:function(){a.onClick({type:b.Beta,context:e,broken:new Set})}},"\u03bb "," "),t," . ",o,")")}}},{key:"isBreakpoint",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,s=this.breakpoints[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){if(i.value.context.identifier===e.identifier)return!0}}catch(r){a=!0,n=r}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}return!1}}]),Object(d.a)(t,[{key:"print",value:function(){return this.rendered}},{key:"onApplication",value:function(e){var t="left",a="right";if(null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(t+=" redex",a+=" redex",e.left instanceof b.Lambda&&(this.argument=e.left.argument)),e.right instanceof b.Application){e.left.visit(this);var n=i.a.createElement("span",{className:t},this.rendered);e.right.visit(this);var s=i.a.createElement("span",{className:a},"( ",this.rendered," )");this.rendered=i.a.createElement("span",{className:"application"},n," ",s)}else{e.left.visit(this);var r=i.a.createElement("span",{className:t},this.rendered);e.right.visit(this);var o=i.a.createElement("span",{className:a},this.rendered);this.rendered=i.a.createElement("span",{className:"application"},r," ",o)}this.argument=null}},{key:"onLambda",value:function(e){var t=this,a=this.argument;if(this.argument!==e.argument&&null!==this.argument&&this.argument.name()===e.argument.name()&&(this.argument=null),e.body instanceof b.Lambda){var n=e.argument,s="argument";this.isBreakpoint(e.argument)&&(s+=" breakpoint"),this.argument&&this.argument.name()===n.name()&&(s+=" substitutedArg");var r=i.a.createElement("span",{className:s,onClick:function(){return t.onClick({type:b.Beta,context:n,broken:new Set})}},e.argument.name());this.printMultiLambda(e,r)}else{var o=e.argument;e.argument.visit(this);var c=this.rendered;e.body.visit(this);var l=this.rendered,u="argument";this.isBreakpoint(e.argument)&&(u+=" breakpoint"),this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda",onClick:function(){t.onClick({type:b.Beta,context:e,broken:new Set})}},"\u03bb "," "),i.a.createElement("span",{className:u,onClick:function(){return t.onClick({type:b.Beta,context:o,broken:new Set})}},c," "," "),". ",l,")")}null!==a&&(this.argument=a)}},{key:"onChurchNumeral",value:function(e){var t=this,a="churchnumeral";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=i.a.createElement("span",{className:a,onClick:function(){return t.onClick({type:b.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onMacro",value:function(e){var t=this,a="macro";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=i.a.createElement("span",{className:a,onClick:function(){return t.onClick({type:b.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onVariable",value:function(e){var t="variable";this.argument&&this.argument.name()===e.name()&&(t+=" substitutedArg"),this.rendered=i.a.createElement("span",{className:t},e.name())}}]),t}(b.ASTVisitor),C=a(24);function T(e){var t=e.lastReduction;return null===t?null:t instanceof b.Beta?i.a.createElement("p",{className:"lastReduction"},"\u03b2 reduction"):t instanceof b.Alpha?i.a.createElement("p",{className:"lastReduction"},"\u03b1 conversion"):t instanceof b.Expansion?i.a.createElement("p",{className:"lastReduction"},"Macro expansion"):t instanceof C.Eta?i.a.createElement("p",{className:"lastReduction"},"\u03b7 conversion"):null}function A(e){var t=e.stepRecord,a=e.addBreakpoint,n=e.breakpoints,s=e.children,r=e.strategy,o=t.ast,c=t.lastReduction,l=t.step;t.message;if(null===o)return null;var u=null,m=new(H(r))(o);m.nextReduction instanceof b.Beta&&(u=m.nextReduction.redex),m.nextReduction instanceof b.Expansion&&(u=m.nextReduction.target);var d=new j(o,a,u,n);return i.a.createElement("span",{className:"step"},i.a.createElement(T,{lastReduction:c}),i.a.createElement("div",{className:"inlineblock"},i.a.createElement("p",{className:"stepNumber"},l," :"),d.print(),s,""===t.message?null:i.a.createElement("p",{className:"stepMessage"},t.message)))}var w,F=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).addBreakpoint=a.addBreakpoint.bind(Object(E.a)(Object(E.a)(a))),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.state,n=t.updateState,s=a.__key,r=a.history,o=a.isRunning,c=a.breakpoints,l=a.isExercise,u=a.strategy,m=a.singleLetterNames;r[r.length-1];return i.a.createElement("div",{className:"box boxEval"},i.a.createElement("ul",null,function(e,t,a,n){for(var i=new Array(t-e+1),s=0,r=e;r<=t;++r)i[s++]=n(a[r],r);return i}(0,r.length-2,r,function(t,n){return i.a.createElement("li",{key:n,className:"inactiveStep"},i.a.createElement(A,{breakpoints:c,addBreakpoint:function(){},stepRecord:t,strategy:u},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(t.ast,a.strategy,m)}})))}),i.a.createElement("li",{key:r.length-1,className:"activeStep"},i.a.createElement(A,{breakpoints:c,addBreakpoint:this.addBreakpoint,stepRecord:r[r.length-1],strategy:u},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(r[r.length-1].ast,a.strategy,m)}})))),i.a.createElement(I,{isRunning:o,isActive:this.props.isActive,makeActive:this.props.makeActive,isExercise:l,makeExercise:function(){return e.props.updateState({isExercise:!0})},endExercise:function(){return e.props.updateState({isExercise:!1})},strategy:u,onStrategy:function(e){return n({strategy:e})},__key:s,singleLetterNames:m}))}},{key:"addBreakpoint",value:function(e){var t=this.props,a=t.state;(0,t.updateState)({breakpoints:[].concat(Object(c.a)(a.breakpoints),[e])})}}]),t}(n.PureComponent);function B(e){var t=e.state,a=t.macroName,n=t.macroExpression;return i.a.createElement("div",{className:"box boxMacro"},a," := ",n)}function M(e){var t=e.state.note;return i.a.createElement("div",{className:"box boxNote"},t)}function U(e){var t=e.state,a=e.updateState,n=e.isActive,s=t.type;return s===w.expression?i.a.createElement("div",{className:""},i.a.createElement(F,{state:t,updateState:a,editExpression:e.editExpression,isActive:n,makeActive:e.makeActive})):s===w.macro?i.a.createElement("div",{className:""},i.a.createElement(B,{state:t})):s===w.note?i.a.createElement("div",{className:""},i.a.createElement(M,{state:t})):i.a.createElement("div",null,"I do not know what to do with this yet.")}function D(e){var t=e.state,a=e.onImport,n=e.onScreenChange,s=t.screen,r=function(e){return Object(l.a)({},e,{submittedExpressions:e.submittedExpressions.map(P)})}(t),o=function(e){var t=new Blob([e],{type:"application/json"});return window.URL.createObjectURL(t)}(JSON.stringify(r));return i.a.createElement("div",{id:"topbar"},i.a.createElement("div",null,i.a.createElement("i",{id:"notebooks",className:"icon fas fa-book-open fa-2x"}),i.a.createElement("p",{className:"iconLabel"},"Notebooks")),i.a.createElement("div",null,s===V.main?i.a.createElement("i",{className:"icon fas fa-list-ul fa-2x",onClick:function(){return n(V.macrolist)}}):i.a.createElement("i",{className:"icon far fa-window-close fa-2x",onClick:function(){return n(V.main)}}),i.a.createElement("p",{className:"iconLabel"},"Macros")),i.a.createElement("div",null,i.a.createElement("a",{className:"export",href:o,download:"notebook_lambdulus.json",onClick:function(){return setTimeout(function(){return window.URL.revokeObjectURL(o)},10)}},i.a.createElement("i",{id:"download",className:"icon fas fa-cloud-download-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Export")),i.a.createElement("div",null,i.a.createElement("input",{type:"file",accept:"application/json",id:"input",onChange:function(e){return function(e,t){var a=e.target.files;if(null===a)return;var n=a[0],i=new FileReader;i.onload=function(e){var a=JSON.parse(i.result);t(function(e){var t=e.macroTable;return Object(l.a)({},e,{submittedExpressions:e.submittedExpressions.map(function(e){return function(e,t){if(e.type===w.expression){var a=e,n=a.singleLetterNames,i=function(e,t){var a=t.singleLetterNames,n=t.macroTable,i=Object(b.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(b.parse)(i,n)}(e.expression,{macroTable:t,singleLetterNames:n});return Object(l.a)({},e,{ast:i,history:[{ast:i,lastReduction:b.None,step:0,message:"",isNormalForm:!1}]})}return e}(e,t)})})}(a))},i.readAsText(n)}(e,a)}}),i.a.createElement("label",{htmlFor:"input"},i.a.createElement("i",{className:"icon fas fa-cloud-upload-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Import")))}function P(e){return e.type===w.expression?Object(l.a)({},e,{ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0}):e}function _(e){var t=e.submittedExpressions,a=e.updateState,n=e.removeExpression,s=e.activeBox,r=e.makeActive;return i.a.createElement("div",{className:"evaluatorSpace"},t.length?i.a.createElement("ul",{className:"evaluatorList"},t.map(function(t,o){return i.a.createElement("li",{key:t.__key},i.a.createElement(U,{state:t,updateState:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return a(e,o)}),removeExpression:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return n(o)}),editExpression:e.editExpression,isActive:o===s,makeActive:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return r(o)})}))})):null)}function Y(e){var t=e.macroTable,a=e.removeMacro;return i.a.createElement("div",{className:"macroSpace"},i.a.createElement("p",null,"Built-in Macros"),i.a.createElement("ul",null,Object.entries(b.builtinMacros).map(function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return i.a.createElement("div",{key:a},i.a.createElement("li",null,i.a.createElement("div",{className:"box boxMacro"},a," := ",n)))})),i.a.createElement("p",null,"User-defined Macros"),i.a.createElement("ul",null,Object.entries(t).map(function(e){var t=Object(u.a)(e,2),n=t[0],s=t[1];return i.a.createElement("div",{key:n},i.a.createElement("li",null,i.a.createElement("div",{className:"box boxMacro"},n," := ",s,i.a.createElement("i",{className:"hiddenMacroIcon far fa-trash-alt",onClick:function(){return a(n)}}))))})))}!function(e){e[e.expression=0]="expression",e[e.macro=1]="macro",e[e.note=2]="note"}(w||(w={}));var V,K,q,G=a(37),J=function(){function e(t){Object(m.a)(this,e),this.roots=t,this.translator=new Map,this.equals=!0,this.context=void 0;var a=t,n=Object(G.a)(a);this.context=n.slice(0),this.compare()}return Object(d.a)(e,[{key:"compare",value:function(){var e=Object(u.a)(this.context,2),t=e[0],a=e[1];if(t instanceof b.Lambda&&a instanceof b.Lambda){var n=new Map(this.translator.entries());this.translator.set(t.argument.name(),a.argument.name()),this.context=[t.right,a.right],this.compare(),this.translator=n}else if(t instanceof b.Application&&a instanceof b.Application){if(this.context=[t.left,a.left],this.compare(),!this.equals)return;this.context=[t.right,a.right],this.compare()}else t instanceof b.Macro&&a instanceof b.Macro?this.equals=t.name()===a.name():t instanceof b.ChurchNumeral&&a instanceof b.ChurchNumeral?this.equals=t.name()===a.name():t instanceof b.Variable&&a instanceof b.Variable?this.equals=this.translator.get(t.name())===a.name():this.equals=!1}}]),e}();function H(e){switch(e){case q.NORMAL:return b.NormalEvaluator;case q.APPLICATIVE:return b.ApplicativeEvaluator;case q.OPTIMISATION:return b.OptimizeEvaluator}}!function(e){e[e.main=0]="main",e[e.macrolist=1]="macrolist",e[e.notebooks=2]="notebooks"}(V||(V={})),function(e){e.INIT="type \u03bb expression",e.EVAL_MODE="HIT ENTER AGAIN FOR NEXT STEP",e.VALIDATE_MODE="HIT ENTER TO VALIDATE YOUR SKILL"}(K||(K={})),function(e){e.NORMAL="Normal Evaluation",e.APPLICATIVE="Applicative Evaluation",e.OPTIMISATION="Optimisation - \u03b7 Conversion "}(q||(q={}));var z=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).parseExpression=a.parseExpression.bind(Object(E.a)(Object(E.a)(a))),a.updateFromURL=a.updateFromURL.bind(Object(E.a)(Object(E.a)(a)));var n=function(e,t){var a;return[function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];window.clearTimeout(a),a=window.setTimeout(function(){e.apply(void 0,i)},t)},function(){window.clearTimeout(a)}]}(a.updateURL.bind(Object(E.a)(Object(E.a)(a))),500),i=Object(u.a)(n,2),s=i[0],r=i[1];a.updateURL=s,a.cancelUpdate=r,a.onExpression=a.onExpression.bind(Object(E.a)(Object(E.a)(a))),a.onSubmit=a.onSubmit.bind(Object(E.a)(Object(E.a)(a))),a.onRemoveExpression=a.onRemoveExpression.bind(Object(E.a)(Object(E.a)(a))),a.updateMacros=a.updateMacros.bind(Object(E.a)(Object(E.a)(a))),a.onUpdateEvaluationState=a.onUpdateEvaluationState.bind(Object(E.a)(Object(E.a)(a))),a.onRemoveMacro=a.onRemoveMacro.bind(Object(E.a)(Object(E.a)(a))),a.onEnter=a.onEnter.bind(Object(E.a)(Object(E.a)(a))),a.onStep=a.onStep.bind(Object(E.a)(Object(E.a)(a))),a.onRemoveLastStep=a.onRemoveLastStep.bind(Object(E.a)(Object(E.a)(a))),a.onExerciseStep=a.onExerciseStep.bind(Object(E.a)(Object(E.a)(a))),a.onRun=a.onRun.bind(Object(E.a)(Object(E.a)(a))),a._onRun=a._onRun.bind(Object(E.a)(Object(E.a)(a))),a.__onRun=a.__onRun.bind(Object(E.a)(Object(E.a)(a))),a.onStop=a.onStop.bind(Object(E.a)(Object(E.a)(a))),a.onClear=a.onClear.bind(Object(E.a)(Object(E.a)(a))),a.shouldBreak=a.shouldBreak.bind(Object(E.a)(Object(E.a)(a))),a.onRun=a.onRun.bind(Object(E.a)(Object(E.a)(a))),window.addEventListener("hashchange",a.updateFromURL);var o=k();return a.state={editorState:{placeholder:K.INIT,expression:o,caretPosition:o.length,syntaxError:null,strategy:q.NORMAL,singleLetterNames:!1,isExercise:!1},macroTable:Object(l.a)({},y,JSON.parse(window.localStorage.getItem("macrotable")||"{}")),submittedExpressions:[],screen:V.main,activeBox:-1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.editorState,n=a.expression,s=a.caretPosition,r=a.syntaxError,o=a.placeholder,c=a.isExercise,u=t.macroTable,m=t.submittedExpressions,d=t.screen,p=t.activeBox,h=i.a.createElement("div",null,"Notebooks are not implemented yet.");return i.a.createElement("div",{className:"app"},i.a.createElement(D,{state:this.state,onImport:function(t){return e.setState(t)},onScreenChange:function(t){return e.setState(Object(l.a)({},e.state,{screen:t}))}}),d===V.main?i.a.createElement(_,{removeExpression:e.onRemoveExpression,updateState:e.onUpdateEvaluationState,submittedExpressions:m,editExpression:function(t,a,n){return e.setState(Object(l.a)({},e.state,{editorState:{placeholder:K.INIT,expression:t.toString(),caretPosition:t.toString().length,syntaxError:null,strategy:a,singleLetterNames:n,isExercise:!1}}))},activeBox:p,makeActive:function(t){return e.setState(Object(l.a)({},e.state,{activeBox:t}))}}):d===V.macrolist?i.a.createElement(Y,{macroTable:u,removeMacro:e.onRemoveMacro}):h,i.a.createElement(S,{placeholder:o,expression:n,caretPosition:s,onExpression:this.onExpression,onEnter:this.onEnter,syntaxError:r,onRun:this.onRun,onReset:this.onClear,strategy:this.state.editorState.strategy,onStrategy:function(t){return e.setState(Object(l.a)({},e.state,{editorState:Object(l.a)({},e.state.editorState,{strategy:t})}))},singleLetterNames:this.state.editorState.singleLetterNames,onSingleLetterNames:function(t){return e.setState(Object(l.a)({},e.state,{editorState:Object(l.a)({},e.state.editorState,{singleLetterNames:t})}))},isExercise:c,onExercise:function(t){return e.setState(Object(l.a)({},e.state,{editorState:Object(l.a)({},e.state.editorState,{isExercise:t})}))}}))}},{key:"updateURL",value:function(e){history.pushState({},"page title?","#"+encodeURI(e))}},{key:"cancelUpdate",value:function(){}},{key:"onExpression",value:function(e,t){this.setState(Object(l.a)({},this.state,{editorState:Object(l.a)({},this.state.editorState,{placeholder:this.state.editorState.placeholder,expression:e,caretPosition:t,syntaxError:null})})),this.updateURL(e)}},{key:"onUpdateEvaluationState",value:function(e,t){var a=this.state.submittedExpressions;a[t]=Object(l.a)({},a[t],e),this.setState(Object(l.a)({},this.state,{submittedExpressions:a}))}},{key:"onRemoveExpression",value:function(){}},{key:"onRemoveLastStep",value:function(){console.log("CURRENTLY NOT IMPEMENTED")}},{key:"onRun",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox];t.type===w.expression&&(!1===t.isRunning?this._onRun():this.onStop())}},{key:"onUpdateBoxState",value:function(e){var t=this.state,a=t.submittedExpressions;a[t.activeBox]=e,this.setState(Object(l.a)({},this.state,{submittedExpressions:a}))}},{key:"_onRun",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox],a=t.timeout,n=t.history,i=n[n.length-1];if(!i.isNormalForm){var s=i.ast,r=i.step,o=i.lastReduction,c=i.isNormalForm;i.message;n.push(n[n.length-1]),n[n.length-2]={ast:s.clone(),step:r,lastReduction:o,message:"Skipping some steps...",isNormalForm:c},this.onUpdateBoxState(Object(l.a)({},t,{history:n,isRunning:!0,timeoutID:window.setTimeout(this.__onRun,a)}))}}},{key:"__onRun",value:function(){var e=this,t=this.state,a=t.submittedExpressions[t.activeBox],n=a.history,i=a.isRunning,s=a.breakpoints,r=a.timeoutID,o=a.timeout,c=a.strategy,u=n[n.length-1],m=u.isNormalForm,d=u.step,p=u.lastReduction;if(i)if(m)this.onUpdateBoxState(Object(l.a)({},a,{isRunning:!1,timeoutID:void 0}));else{var h=n[n.length-1].ast,f=new(H(c))(h);if(p=f.nextReduction,f.nextReduction instanceof b.None)return n.pop(),n.push({ast:h,lastReduction:u.lastReduction,step:d,message:"Expression is in normal form.",isNormalForm:!0}),void this.onUpdateBoxState(Object(l.a)({},a,{history:n,isRunning:!1,timeoutID:void 0}));var E=s.find(function(t){return e.shouldBreak(t,f.nextReduction)});if(void 0!==E)return f.nextReduction instanceof b.Expansion&&E.broken.add(f.nextReduction.target),window.clearTimeout(r),void this.onUpdateBoxState(Object(l.a)({},a,{isRunning:!1,breakpoints:s,timeoutID:void 0}));h=f.perform(),n[n.length-1]={ast:h,lastReduction:p,step:d+1,message:"",isNormalForm:m},this.onUpdateBoxState(Object(l.a)({},a,{history:n,timeoutID:window.setTimeout(this.__onRun,o)}))}}},{key:"onStop",value:function(){var e=this.state,t=e.submittedExpressions[e.activeBox],a=t.timeoutID;window.clearTimeout(a),this.onUpdateBoxState(Object(l.a)({},t,{isRunning:!1,timeoutID:void 0}))}},{key:"shouldBreak",value:function(e,t){return t instanceof e.type&&t instanceof b.Beta&&e.context instanceof b.Lambda&&t.target.identifier===e.context.body.identifier||(t instanceof e.type&&t instanceof b.Beta&&e.context instanceof b.Variable&&t.redex.left instanceof b.Lambda&&t.redex.left.argument.identifier===e.context.identifier||(t instanceof e.type&&t instanceof b.Expansion&&e.context instanceof b.ChurchNumeral&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)||t instanceof e.type&&t instanceof b.Expansion&&e.context instanceof b.Macro&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)))}},{key:"onClear",value:function(){var e=this.state,t=e.submittedExpressions,a=e.activeBox;if(void 0!==t[a]&&t[a].type===w.expression){var n=t[a];this.onUpdateBoxState(Object(l.a)({},n,{history:[{ast:n.ast.clone(),lastReduction:b.None,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[]}))}}},{key:"onEnter",value:function(){var e=this.state,t=e.editorState.expression,a=e.submittedExpressions[e.activeBox];void 0!==a&&a.isExercise?this.onExerciseStep():t.length||void 0===a||a.type!==w.expression?this.onSubmit():this.onStep()}},{key:"onExerciseStep",value:function(){var e=this.state.editorState.expression;try{var t=this.parseExpression(e),a=this.state,n=a.submittedExpressions,i=a.activeBox,s=n[i],r=s.history,o=s.strategy,u=r[r.length-1],m=u.isNormalForm,d=u.step,p=u.ast,h=u.lastReduction;if(p=p.clone(),m)return u.message="No more steps available. Expression is in normal form.",void this.setState(Object(l.a)({},this.state,{submittedExpressions:n}));var f=new(H(o))(p);if(h=f.nextReduction,f.nextReduction instanceof b.None)return u.isNormalForm=!0,u.message="Expression is already in normal form.",n[i]=Object(l.a)({},s,{history:r}),void this.setState(Object(l.a)({},this.state,{submittedExpressions:n}));p=f.perform();var E="";new J([t,p]).equals?(p=t,E="Correct."):(console.log("Incorrect step"),E="Incorrect step. ".concat(e)),n[i]=Object(l.a)({},s,{history:[].concat(Object(c.a)(r),[{ast:p,lastReduction:h,step:d+1,message:E,isNormalForm:!1}])}),this.setState(Object(l.a)({},this.state,{editorState:Object(l.a)({},this.state.editorState,{expression:"",caretPosition:0,placeholder:K.VALIDATE_MODE,syntaxError:null}),submittedExpressions:n}))}catch(v){this.onSubmit()}}},{key:"onStep",value:function(){var e=this.state,t=e.submittedExpressions,a=e.activeBox,n=t[a],i=n.history,s=n.strategy,r=i[i.length-1],o=r.isNormalForm,u=r.step,m=r.ast,d=r.lastReduction;if(m=m.clone(),!o){var p=new(H(s))(m);if(d=p.nextReduction,p.nextReduction instanceof b.None)return r.isNormalForm=!0,r.message="Expression is in normal form.",t[a]=Object(l.a)({},n,{history:i}),void this.setState(Object(l.a)({},this.state,{submittedExpressions:t}));m=p.perform(),t[a]=Object(l.a)({},n,{history:[].concat(Object(c.a)(i),[{ast:m,lastReduction:d,step:u+1,message:"",isNormalForm:!1}])}),this.setState(Object(l.a)({},this.state,{submittedExpressions:t}))}}},{key:"onSubmit",value:function(){this.cancelUpdate();var e=this.state,t=e.editorState,a=t.expression,n=t.caretPosition,i=e.submittedExpressions,s=e.macroTable;e.activeBox;if(history.pushState({},"","#"+encodeURI(a)),function(e){try{return e.indexOf(":=")>0}catch(t){return!1}}(a)){history.pushState({},"","#"+encodeURI(""));var r=a.split(":=").map(O),m=Object(u.a)(r,2),d=m[0],p=m[1],h={type:w.macro,__key:Date.now().toString(),macroName:d,macroExpression:p},f=Object(l.a)({},s,Object(o.a)({},d,p));this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise},submittedExpressions:[].concat(Object(c.a)(i),[h]),macroTable:f,activeBox:i.length})),this.updateMacros(f)}else if(function(e){return 0===e.indexOf("#")}(a)){history.pushState({},"","#"+encodeURI(""));var E={type:w.note,__key:Date.now().toString(),note:a.substring(1)};this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise},submittedExpressions:[].concat(Object(c.a)(i),[E]),activeBox:i.length}))}else try{var v=this.parseExpression(a);history.pushState({},"","#"+encodeURI(""));var x={type:w.expression,__key:Date.now().toString(),expression:a,ast:v,history:[{ast:v.clone(),lastReduction:b.None,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:this.state.editorState.isExercise,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames};this.setState(Object(l.a)({},this.state,{editorState:{placeholder:K.EVAL_MODE,expression:"",caretPosition:0,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise},submittedExpressions:[].concat(Object(c.a)(i),[x]),activeBox:i.length}))}catch(g){this.updateURL(a),console.log(g),this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:a,caretPosition:n,syntaxError:g,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise}}))}}},{key:"updateFromURL",value:function(){var e=this.state.editorState.expression,t=k();e!==t?this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:t,caretPosition:t.length,syntaxError:null,strategy:this.state.editorState.strategy,singleLetterNames:this.state.editorState.singleLetterNames,isExercise:this.state.editorState.isExercise}})):console.log("ALREADY SYNCED")}},{key:"parseExpression",value:function(e){var t=this.state.macroTable,a=this.state.editorState.singleLetterNames,n=Object(b.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(b.parse)(n,t)}},{key:"onRemoveMacro",value:function(e){var t=this.state.macroTable,a=Object(l.a)({},t);delete a[e],this.setState(Object(l.a)({},this.state,{macroTable:a})),this.updateMacros(a)}},{key:"updateMacros",value:function(e){window.localStorage.setItem("macrotable",JSON.stringify(e))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[38,1,2]]]);
//# sourceMappingURL=main.c2b53731.chunk.js.map