(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},104:function(e,t,n){},189:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(55),o=n.n(i),s=(n(63),n(26)),c=n(19),l=n(1),u=n(12),m=n(11),d=n(15),p=n(14),E=n(16),f=n(3),h=(n(64),n(2));function b(){return JSON.parse(window.localStorage.getItem("macrotable")||"{}")}function v(e){return e.trim()}var x,g,O,N={FACT:"(Y (\u03bb f n . (<= n 1) 1 (* n (f (- n 1)))))",FACCT:"(\u03bb n . (Y (\u03bb f n a . IF (= n 1) a (f (- n 1) (* n a)))) (- n 1) (n))",FIB:"(Y (\u03bb f n . (= n 0) 0 ((= n 1) 1 ( + (f (- n 1)) (f (- n 2))))))",APPEND:"Y (\u03bb fn listA listB . IF (NULL listA) (listB) (CONS (FIRST listA) (fn (SECOND listA) listB)))",LISTGREQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (>= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTLESS:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (< (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTGR:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (> (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTEQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",QUICKSORT:"Y (\u03bb fn list . IF (NULL list) (NIL) ( IF (NULL (SECOND list)) (list) ( APPEND (fn (LISTLESS (FIRST list) list)) ( APPEND (LISTEQ (FIRST list) list) (fn (LISTGR (FIRST list) list)) ) ) ) )",INFLIST:"(\u03bb n . (Y (\u03bb x . (\u03bb f s g . g f s) n x)))",REMOVENTH:"Y (\u03bb fn list n . IF (= n 0) (SECOND list) (IF (NULL list) NIL (CONS (FIRST list) (fn (SECOND list) (- n 1) ) ) ) )",NTH:"Y (\u03bb fn list n . IF (= n 0) (FIRST list) (IF (NULL (list)) NIL (fn (SECOND list) (- n 1)) ) )",LEN:"Y (\u03bb fn list . IF (NULL list) (0) (+ 1 (fn (SECOND list) )) )",GETNTH:"(\u03bb end . (Y (\u03bb f n i . (end i) (i) ( (= n 0) (Y (\u03bb f a . (end a) (i) (f) ) ) (f (- n 1)) ) )) )",MAP:"(\u03bb fn l . (Y (\u03bb f it . IF (NULL it) (NIL) (CONS (fn (FIRST it)) (f (SECOND it))) )) l )",REDUCE:"(\u03bb fn l init . Y (\u03bb f it acc . IF (NULL it) (acc) (f (SECOND it) (fn (FIRST it) acc)) ) l init )",APPLY:"(\u03bb f args . Y (\u03bb ff f l . (NULL l) (f) (ff (f (FIRST l)) (SECOND l)) ) f args )",RANGE:"(\u03bb m n . Y (\u03bb f e . (= e n) (CONS e NIL) (CONS e (f (+ e 1))) ) m )",LISTCOMPR:"(\u03bb args . APPLY (\u03bb op in rng cond . Y (\u03bb f l . (NULL l) (NIL) ( (cond (FIRST l)) (CONS (op (FIRST l)) (f (SECOND l))) (CONS (FIRST l) (f (SECOND l))) ) ) rng ) args )",MOD:"(\u03bb n m . (n (\u03bb n . (= n (- m 1)) (0) (+ n 1)) (0)) )",INFIX:"APPLY (\u03bb l op r . op l r)"};function S(e){window.localStorage.setItem("macrotable",JSON.stringify(e))}function y(e,t,n){try{window.ga.getAll()[0].send("event",e,t,n)}catch(a){console.log(""),console.log("PLEASE DISABLE YOUR ADBLOCKER OR ALLOW GOOGLE ANALYTICS FOR THIS SITE"),console.log(""),console.error(a)}}!function(e){e.NORMAL="Normal Evaluation",e.APPLICATIVE="Applicative Evaluation",e.OPTIMISATION="Optimisation - \u03b7 Conversion"}(x||(x={})),function(e){e[e.main=0]="main",e[e.macrolist=1]="macrolist"}(g||(g={})),function(e){e.INIT="Type \u03bb expression and hit enter",e.EVAL_MODE="Hit enter for next step",e.VALIDATE_MODE="Write next step and hit enter for validation",e.MACRO="Define Macro like: `NAME := [\u03bb expression]` and hit enter",e.NOTE="Type note and hit shift enter"}(O||(O={}));var j,k={macroTable:Object(l.a)({},N,b()),submittedBoxes:[],screen:g.main,activeBoxIndex:-1};!function(e){e[e.EXPRESSION=0]="EXPRESSION",e[e.MACRO=1]="MACRO",e[e.NOTE=2]="NOTE"}(j||(j={}));n(99);function I(e){var t=e.state,n=e.onImport,a=e.onScreenChange,i=t.screen,o=function(e){return Object(l.a)({},e,{submittedBoxes:e.submittedBoxes.map(L)})}(t),s=function(e){var t=new Blob([e],{type:"application/json"});return window.URL.createObjectURL(t)}(JSON.stringify(o));return r.a.createElement("div",{id:"topbar"},r.a.createElement("div",null,i===g.main?r.a.createElement("i",{className:"icon fas fa-list-ul fa-2x",onClick:function(){return a(g.macrolist)}}):r.a.createElement("i",{className:"icon far fa-window-close fa-2x",onClick:function(){return a(g.main)}}),r.a.createElement("p",{className:"iconLabel"},"Macros")),r.a.createElement("div",null,r.a.createElement("a",{className:"export",href:s,download:"notebook_lambdulus.json",onClick:function(){return setTimeout(function(){return window.URL.revokeObjectURL(s)},10)}},r.a.createElement("i",{id:"download",className:"icon fas fa-cloud-download-alt fa-2x"})),r.a.createElement("p",{className:"iconLabel"},"Export")),r.a.createElement("div",null,r.a.createElement("input",{type:"file",accept:"application/json",id:"input",onChange:function(e){return function(e,t){var n=e.target.files;if(null===n)return;var a=n[0],r=new FileReader;r.onload=function(e){var n=JSON.parse(r.result);t(function(e){var t=e.macroTable;return Object(l.a)({},e,{submittedBoxes:e.submittedBoxes.map(function(e){return function(e,t){if(e.type===j.EXPRESSION){var n=e,a=n.singleLetterNames,r=function(e,t){var n=t.singleLetterNames,a=t.macroTable,r=Object(h.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:n});return Object(h.parse)(r,a)}(e.expression,{macroTable:t,singleLetterNames:a});return Object(l.a)({},e,{ast:r,history:[{ast:r,lastReduction:h.None,step:0,message:"",isNormalForm:!1}]})}return e}(e,t)})})}(n))},r.readAsText(a)}(e,n)}}),r.a.createElement("label",{htmlFor:"input"},r.a.createElement("i",{className:"icon fas fa-cloud-upload-alt fa-2x"})),r.a.createElement("p",{className:"iconLabel"},"Import")))}function L(e){return e.type===j.EXPRESSION?Object(l.a)({},e,{ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0}):e}var C=n(20);function R(e){var t=e.macroTable,n=e.removeMacro;return r.a.createElement("div",{className:"macroSpace"},r.a.createElement("div",{className:"builtinMacros"},r.a.createElement("p",null,"Built-in Macros"),r.a.createElement("ul",{className:"UL"},Object.entries(h.builtinMacros).map(function(e){var t=Object(C.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{key:n},r.a.createElement("li",{className:"LI"},r.a.createElement("div",{className:"box boxMacro"},n," := ",a)))}))),r.a.createElement("div",{className:"userMacros"},r.a.createElement("p",null,"User-defined Macros"),r.a.createElement("ul",null,Object.entries(t).map(function(e){var t=Object(C.a)(e,2),a=t[0],i=t[1];return r.a.createElement("div",{key:a},r.a.createElement("li",{className:"LI"},r.a.createElement("div",{className:"box boxMacro"},a," := ",i,r.a.createElement("i",{className:"hiddenMacroIcon far fa-trash-alt",onClick:function(){return n(a)}}))))}))))}var B=n(46),A=B.Switch,w=B.Radio;function T(e){return r.a.createElement("div",{className:"editorSettings"},r.a.createElement(A,{checked:e.getActiveSingleLetterNames(),disabled:!1,shape:"fill",onChange:function(t){return e.changeActiveSingleLetterNames(t.target.checked)}},"Single Letter Names"),r.a.createElement("div",{className:"strategies inlineblock"},r.a.createElement("p",{className:"stratsLabel inlineblock"},"Evaluation Strategies:"),r.a.createElement(w,{name:"strategy",style:"fill",checked:e.getActiveStrategy()===x.NORMAL,onChange:function(){return e.changeActiveStrategy(x.NORMAL)}},"Normal"),r.a.createElement(w,{style:"fill",name:"strategy",checked:e.getActiveStrategy()===x.APPLICATIVE,onChange:function(){return e.changeActiveStrategy(x.APPLICATIVE)}},"Applicative")))}n(100);var F,M=n(56),P=function(){function e(t){Object(u.a)(this,e),this.roots=t,this.translator=new Map,this.equals=!0,this.context=void 0;var n=t,a=Object(M.a)(n);this.context=a.slice(0),this.compare()}return Object(m.a)(e,[{key:"compare",value:function(){var e=Object(C.a)(this.context,2),t=e[0],n=e[1];if(t instanceof h.Lambda&&n instanceof h.Lambda){var a=new Map(this.translator.entries());this.translator.set(t.argument.name(),n.argument.name()),this.context=[t.right,n.right],this.compare(),this.translator=a}else if(t instanceof h.Application&&n instanceof h.Application){if(this.context=[t.left,n.left],this.compare(),!this.equals)return;this.context=[t.right,n.right],this.compare()}else t instanceof h.Macro&&n instanceof h.Macro?this.equals=t.name()===n.name():t instanceof h.ChurchNumeral&&n instanceof h.ChurchNumeral?this.equals=t.name()===n.name():t instanceof h.Variable&&n instanceof h.Variable?this.equals=this.translator.get(t.name())===n.name():this.equals=!1}}]),e}();n(101);function D(e){var t=e.placeholder,n=e.content,a=e.caretPosition,i=e.syntaxError,o=e.isMarkDown,s=e.onContent,c=e.onEnter,l=e.onExecute,u=n.split("\n").length;return r.a.createElement("div",{className:"editorContainer"},i?r.a.createElement("p",{className:"editorError"},"".concat(i)):null,r.a.createElement("div",{className:"editor"},r.a.createElement(U,{placeholder:t,content:n,lines:u,caretPosition:a,onChange:function(e){var t=e.target.value,n=e.target.selectionEnd;t=t.replace(/\\/g,"\u03bb"),s(t,n)},onKeyDown:function(e){if(!e.shiftKey&&!e.ctrlKey&&"Enter"===e.key){if(o)return;e.preventDefault(),c()}e.shiftKey&&"Enter"===e.key&&o&&(e.preventDefault(),c()),e.ctrlKey&&"Enter"===e.key&&(e.preventDefault(),l())}})))}function U(e){var t=e.placeholder,n=e.content,a=e.lines,i=e.onChange,o=e.onKeyDown,s=e.caretPosition;return r.a.createElement("textarea",{className:"prompt",onKeyDown:o,onChange:i,value:n,placeholder:t,wrap:"hard",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,rows:Math.max(a,1),ref:function(e){null!==e&&(e.selectionStart=s,e.selectionEnd=s,e.focus())}})}!function(e){e.ENTER_EXPRESSION="Enter Expression",e.ENTER_EXERCISE="Enter Exercise",e.NEXT_STEP="Next Step",e.RUN="Run",e.ENTER_MD="Enter MarkDown"}(F||(F={}));var Y=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.isActive,i=t.editor,o=i.placeholder,s=i.content,c=i.caretPosition,l=i.syntaxError;return r.a.createElement(fe.Consumer,null,function(t){return r.a.createElement("div",{className:"".concat(n," ").concat(a?"":" inactiveBox"),onDoubleClick:t},a?r.a.createElement(D,{placeholder:o,content:s,caretPosition:c,syntaxError:l,isMarkDown:!1,onContent:e.props.onContent,onEnter:e.props.onEnter,onExecute:e.props.onExecute}):r.a.createElement("p",{className:"inactiveMessage"},"Collapsing ",Math.max(0,e.props.history.length-1)," ",2===e.props.history.length?"step":"steps",". Double click to activate this box."))})}}]),t}(a.PureComponent),_=(n(102),function(e){function t(e,n,a,r){var i;return Object(u.a)(this,t),(i=Object(d.a)(this,Object(p.a)(t).call(this))).tree=e,i.onClick=n,i.reduction=a,i.breakpoints=r,i.rendered=null,i.argument=null,i.tree.visit(Object(f.a)(Object(f.a)(i))),i}return Object(E.a)(t,e),Object(m.a)(t,[{key:"printMultiLambda",value:function(e,t){var n=this;if(e.body instanceof h.Lambda){var a=e.body.argument,i="argument";this.isBreakpoint(e.body.argument)&&(i+=" breakpoint");var o=!1;this.reduction instanceof h.Alpha&&Array.from(this.reduction.conversions).some(function(t){return t.identifier===e.body.identifier})&&(this.argument=a,o=!0);var s=this.argument;this.argument!==e.body.argument&&null!==this.argument&&this.argument.name()===e.body.argument.name()&&(this.argument=null),this.argument&&this.argument.name()===a.name()&&(i+=" substitutedArg");var c=r.a.createElement("span",{className:"arguments"},t," "," ",r.a.createElement("span",{className:i,onClick:function(){a.identifier=Symbol(),n.onClick({type:h.Beta,context:a,broken:new Set})}},a.name()));this.printMultiLambda(e.body,c),!0===o&&(this.argument=null),this.argument=s}else{e.body.visit(this);var l=this.rendered;this.rendered=t,this.rendered=r.a.createElement("span",{className:"function"},"(",r.a.createElement("span",{className:"lambda"},"\u03bb "," "),t," . ",l,")")}}},{key:"isBreakpoint",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=this.breakpoints[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(r.value.context.identifier===e.identifier)return!0}}catch(o){n=!0,a=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}return!1}}]),Object(m.a)(t,[{key:"print",value:function(){return this.rendered}},{key:"onApplication",value:function(e){var t="left",n="right",a=!1,i=null;if(this.reduction instanceof h.Beta&&(i=this.reduction.redex),null!==i&&i.identifier===e.identifier&&i===e&&(t+=" redex",n+=" redex",e.left instanceof h.Lambda&&(this.argument=e.left.argument,a=!0)),e.right instanceof h.Application){e.left.visit(this);var o=r.a.createElement("span",{className:t},this.rendered);a&&(this.argument=null),e.right.visit(this);var s=r.a.createElement("span",{className:n},"( ",this.rendered," )");this.rendered=r.a.createElement("span",{className:"application"},o," ",s)}else{e.left.visit(this);var c=r.a.createElement("span",{className:t},this.rendered);a&&(this.argument=null),e.right.visit(this);var l=r.a.createElement("span",{className:n},this.rendered);this.rendered=r.a.createElement("span",{className:"application"},c," ",l)}}},{key:"onLambda",value:function(e){var t=this,n=this.argument;if(this.argument!==e.argument&&null!==this.argument&&this.argument.name()===e.argument.name()&&(this.argument=null),e.body instanceof h.Lambda){var a=e.argument,i="argument";this.isBreakpoint(e.argument)&&(i+=" breakpoint"),this.argument&&this.argument.name()===a.name()&&(i+=" substitutedArg");var o=r.a.createElement("span",{className:i,onClick:function(){a.identifier=Symbol(),t.onClick({type:h.Beta,context:a,broken:new Set})}},e.argument.name());this.printMultiLambda(e,o)}else{var s=e.argument;e.argument.visit(this);var c=this.rendered;e.body.visit(this);var l=this.rendered,u="argument";this.isBreakpoint(e.argument)&&(u+=" breakpoint"),this.rendered=r.a.createElement("span",{className:"function"},"(",r.a.createElement("span",{className:"lambda"},"\u03bb "," "),r.a.createElement("span",{className:u,onClick:function(){s.identifier=Symbol(),t.onClick({type:h.Beta,context:s,broken:new Set})}},c," "," "),". ",l,")")}null!==n&&(this.argument=n)}},{key:"onChurchNumeral",value:function(e){var t=this,n="churchnumeral",a=this.reduction instanceof h.Expansion?this.reduction.target:null;null!==a&&a.identifier===e.identifier&&a===e&&(n+=" redex"),this.isBreakpoint(e)&&(n+=" breakpoint"),this.rendered=r.a.createElement("span",{className:n,onClick:function(){e.identifier=Symbol(),t.onClick({type:h.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onMacro",value:function(e){var t=this,n="macro",a=this.reduction instanceof h.Expansion?this.reduction.target:null;null!==a&&a.identifier===e.identifier&&a===e&&(n+=" redex"),this.isBreakpoint(e)&&(n+=" breakpoint"),this.rendered=r.a.createElement("span",{className:n,onClick:function(){e.identifier=Symbol(),t.onClick({type:h.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onVariable",value:function(e){var t="variable";this.argument&&this.argument.name()===e.name()&&(t+=" substitutedArg"),this.rendered=r.a.createElement("span",{className:t},e.name())}}]),t}(h.ASTVisitor)),V=n(30);function J(e){var t=e.lastReduction;return null===t?null:t instanceof h.Beta?r.a.createElement("p",{className:"lastReduction"},"\u03b2 reduction"):t instanceof h.Alpha?r.a.createElement("p",{className:"lastReduction"},"\u03b1 conversion"):t instanceof h.Expansion?r.a.createElement("p",{className:"lastReduction"},"Macro expansion"):t instanceof V.Eta?r.a.createElement("p",{className:"lastReduction"},"\u03b7 conversion"):null}var X=Object(a.createContext)(k),K=Object(a.createContext)(!0),q=Object(a.createContext)(x.NORMAL);function G(e){var t=e.state,n=e.SLI,a=e.strategy,i=e.children;return r.a.createElement(X.Provider,{value:t},r.a.createElement(q.Provider,{value:a},r.a.createElement(K.Provider,{value:n},i)))}var z=Object(a.memo)(function(e){var t=e.stepRecord,n=e.addBreakpoint,a=e.breakpoints,i=e.children,o=e.strategy,s=t.ast,c=t.lastReduction,l=t.step;t.message;if(null===s)return null;var u=new(se(o))(s).nextReduction,m=new _(s,n,u,a);return r.a.createElement("span",{className:"step"},r.a.createElement(J,{lastReduction:c}),r.a.createElement("div",{className:"inlineblock"},r.a.createElement("p",{className:"stepNumber"},l," :"),m.print(),i,""===t.message?null:r.a.createElement("p",{className:"stepMessage"},t.message)))},function(e){return!e.lastStep});function H(e){return r.a.createElement(q.Consumer,null,function(t){return r.a.createElement(z,Object.assign({},e,{strategy:t}))})}var Q=Object(a.createContext)(function(e){}),W=Object(a.createContext)(function(e){}),$=Object(a.createContext)(function(e){}),Z=Object(a.createContext)(function(e,t){}),ee=Object(a.createContext)(function(e,t){});function te(e){var t=e.addBox,n=e.addEmptyBox,a=e.changeActiveBox,i=e.setBoxState,o=e.defineMacro,s=e.children;return r.a.createElement(Q.Provider,{value:t},r.a.createElement(W.Provider,{value:n},r.a.createElement($.Provider,{value:a},r.a.createElement(Z.Provider,{value:i},r.a.createElement(ee.Provider,{value:o},s)))))}var ne=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.className;return r.a.createElement("div",{className:t+" inactiveBox",onDoubleClick:this.props.makeActive},r.a.createElement("ul",{className:"UL"},r.a.createElement("li",{key:0,className:"activeStep LI"},r.a.createElement(H,{breakpoints:this.props.breakpoints,addBreakpoint:function(){},stepRecord:this.props.history[0],lastStep:!1},r.a.createElement(Q.Consumer,null,function(t){return r.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return t(e.props.createBoxFrom(e.props.history[0]))}})})))),r.a.createElement("p",{className:"inactiveMessage"},"Collapsing ",this.props.history.length-1," ",2===this.props.history.length?"step":"steps",". Double click to activate this box."))}}]),t}(a.PureComponent),ae=(n(103),n(104),n(46)),re=ae.Switch;ae.Radio;function ie(e){var t=e.isExercise,n=e.makeExercise,a=e.endExercise;return r.a.createElement("div",{id:"controls"},r.a.createElement("div",null,r.a.createElement(re,{className:"exerciseSwitch",checked:t,onChange:function(e){return e.target.checked?n():a()},shape:"fill"},"Exercise")))}var oe=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.isExercise,i=t.state,o=t.editor,s=o.placeholder,c=o.content,u=o.caretPosition,m=o.syntaxError;return r.a.createElement("div",{className:n},r.a.createElement(ie,{isExercise:a,makeExercise:function(){return e.props.setBoxState(Object(l.a)({},i,{isExercise:!0,editor:Object(l.a)({},i.editor,{placeholder:O.VALIDATE_MODE})}))},endExercise:function(){return e.props.setBoxState(Object(l.a)({},i,{isExercise:!1,editor:Object(l.a)({},i.editor,{placeholder:O.EVAL_MODE})}))}}),r.a.createElement(Q.Consumer,null,function(t){return r.a.createElement("ul",{className:"UL"},function(e,t,n,a){for(var r=new Array(t-e+1),i=0,o=e;o<=t;++o)r[i++]=a(n[o],o);return r}(0,e.props.history.length-2,e.props.history,function(n,a){return r.a.createElement("li",{key:a.toString(),className:"inactiveStep LI"},r.a.createElement(H,{breakpoints:e.props.breakpoints,addBreakpoint:function(){},stepRecord:n,lastStep:!1},r.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return t(e.props.createBoxFrom(n))}})))}),r.a.createElement("li",{key:e.props.history.length-1,className:"activeStep LI"},r.a.createElement(H,{breakpoints:e.props.breakpoints,addBreakpoint:e.addBreakpoint,stepRecord:e.props.history[e.props.history.length-1],lastStep:!0},r.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return t(e.props.createBoxFrom(e.props.history[e.props.history.length-1]))}}))))}),this.props.isNormalForm?null:r.a.createElement(D,{placeholder:s,content:c,caretPosition:u,syntaxError:m,isMarkDown:!1,onContent:this.props.onContent,onEnter:this.props.onEnter,onExecute:this.props.onExecute}))}},{key:"addBreakpoint",value:function(e){var t=this.props,n=t.state;(0,t.setBoxState)(Object(l.a)({},n,{breakpoints:[].concat(Object(c.a)(n.breakpoints),[e])}))}}]),t}(a.PureComponent);function se(e){switch(e){case x.NORMAL:return h.NormalEvaluator;case x.APPLICATIVE:return h.ApplicativeEvaluator;case x.OPTIMISATION:return h.OptimizeEvaluator}}var ce=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).onContent=n.onContent.bind(Object(f.a)(Object(f.a)(n))),n.onSubmitExpression=n.onSubmitExpression.bind(Object(f.a)(Object(f.a)(n))),n.parseExpression=n.parseExpression.bind(Object(f.a)(Object(f.a)(n))),n.onEnter=n.onEnter.bind(Object(f.a)(Object(f.a)(n))),n.onExerciseStep=n.onExerciseStep.bind(Object(f.a)(Object(f.a)(n))),n.onStep=n.onStep.bind(Object(f.a)(Object(f.a)(n))),n.onExecute=n.onExecute.bind(Object(f.a)(Object(f.a)(n))),n.onRun=n.onRun.bind(Object(f.a)(Object(f.a)(n))),n.onStop=n.onStop.bind(Object(f.a)(Object(f.a)(n))),n.shouldBreak=n.shouldBreak.bind(Object(f.a)(Object(f.a)(n))),n.createBoxFrom=n.createBoxFrom.bind(Object(f.a)(Object(f.a)(n))),n}return Object(E.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.state,a=t.isActive,i=n.history,o=n.breakpoints,s=n.isExercise,c=(n.strategy,n.expression),l=n.editor,u="box boxEval",m=(i.length?i[i.length-1]:{isNormalForm:!1}).isNormalForm;return""===c?r.a.createElement(Y,{className:u,isActive:this.props.isActive,editor:l,history:i,onContent:this.onContent,onEnter:this.onEnter,onExecute:this.onExecute}):(s&&(u+=" boxExercise"),a?r.a.createElement(oe,{className:u,isExercise:s,state:n,breakpoints:o,history:i,editor:l,isNormalForm:m,createBoxFrom:this.createBoxFrom,setBoxState:this.props.setBoxState,onContent:this.onContent,onEnter:this.onEnter,onExecute:this.onExecute}):r.a.createElement(fe.Consumer,null,function(t){return r.a.createElement(ne,{className:u,breakpoints:o,history:i,makeActive:t,createBoxFrom:e.createBoxFrom})}))}},{key:"createBoxFrom",value:function(e){var t=this.props.state,n=t.strategy,a=t.singleLetterNames,r=e.ast;return{type:j.EXPRESSION,__key:Date.now().toString(),expression:r.toString(),ast:r.clone(),history:[{ast:r.clone(),lastReduction:null,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:!1,strategy:n,singleLetterNames:a,editor:{placeholder:O.EVAL_MODE,content:"",caretPosition:0,syntaxError:null}}}},{key:"onContent",value:function(e,t){var n=this.props,a=n.state;(0,n.setBoxState)(Object(l.a)({},a,{editor:Object(l.a)({},a.editor,{content:e,caretPosition:t,syntaxError:null})}))}},{key:"onEnter",value:function(){var e=this.props.state,t=e.expression,n=e.isExercise,a=e.editor.content;""===t?this.onSubmitExpression():""!==a&&n?this.onExerciseStep():""!==a||n?console.log("Error: Something unexpected just happened. A"):this.onStep()}},{key:"onSubmitExpression",value:function(){var e=this.props,t=e.state,n=e.setBoxState,a=t.editor.content;try{var r=this.parseExpression(a);n(Object(l.a)({},t,{ast:r,expression:a,history:[{ast:r.clone(),lastReduction:h.None,step:0,message:"",isNormalForm:!1}],editor:{content:"",caretPosition:0,placeholder:O.EVAL_MODE,syntaxError:null}})),y("Submit Expression","submit valid",a)}catch(i){n(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:i.toString()})})),y("Submit Expression","submit invalid",a)}}},{key:"onExerciseStep",value:function(){var e=this.props,t=e.state,n=e.setBoxState,a=t.strategy,r=t.history,i=t.editor.content;try{var o=this.parseExpression(i),s=r[r.length-1],u=s.isNormalForm,m=s.step,d=s.ast,p=s.lastReduction;if(d=d.clone(),u)return s.message="No more steps available. Expression is in normal form.",n(Object(l.a)({},t)),void y("Exercise Step","Step Already in normal form",i);var E=new(se(a))(d);if(p=E.nextReduction,E.nextReduction instanceof h.None)return s.isNormalForm=!0,s.message="Expression is already in normal form.",n(Object(l.a)({},t)),void y("Exercise Step","Step Already in Normal Form",i);d=E.perform();var f="";new P([o,d]).equals?(d=o,f="Correct.",y("Exercise Step","Valid Step",i)):(console.log("Incorrect step"),f="Incorrect step. ".concat(i),y("Exercise Step","Invalid Step",i)),n(Object(l.a)({},t,{history:[].concat(Object(c.a)(r),[{ast:d,lastReduction:p,step:m+1,message:f,isNormalForm:!1}]),editor:Object(l.a)({},t.editor,{content:"",caretPosition:0,placeholder:O.VALIDATE_MODE,syntaxError:null})}))}catch(b){y("Exercise Step","Syntax error in Step",i)}}},{key:"onStep",value:function(){var e=this.props,t=e.state,n=e.setBoxState,a=t.strategy,r=t.history,i=(t.editor.content,r[r.length-1]),o=i.isNormalForm,s=i.step,u=i.ast,m=i.lastReduction;if(u=u.clone(),!o){var d=new(se(a))(u);if(m=d.nextReduction,d.nextReduction instanceof h.None)return i.isNormalForm=!0,i.message="Expression is in normal form.",n(Object(l.a)({},t)),void y("Evaluation Step","Step Normal Form Reached",u.toString());u=d.perform(),n(Object(l.a)({},t,{history:[].concat(Object(c.a)(r),[{ast:u,lastReduction:m,step:s+1,message:"",isNormalForm:!1}])})),y("Evaluation Step","Step",u.toString())}}},{key:"onExecute",value:function(){var e=this.props,t=e.state,n=e.setBoxState,a=t.isRunning;if(!t.isExercise)if(a)this.onStop();else{var r=t.timeout,i=t.history,o=i[i.length-1];if(o.isNormalForm)return;var s=o.ast,c=o.step,u=o.lastReduction,m=o.isNormalForm;o.message;i.push(i[i.length-1]),i[i.length-2]={ast:s.clone(),step:c,lastReduction:u,message:"Skipping some steps...",isNormalForm:m},n(Object(l.a)({},t,{isRunning:!0,timeoutID:window.setTimeout(this.onRun,r)})),y("Execution","Run Evaluation",s.toString())}}},{key:"onRun",value:function(){var e=this,t=this.props,n=t.state,a=t.setBoxState,r=n.strategy,i=n.history,o=n.isRunning,s=n.breakpoints,c=n.timeoutID,u=n.timeout,m=i[i.length-1],d=m.isNormalForm,p=m.step,E=m.lastReduction;if(o)if(d)a(Object(l.a)({},n,{isRunning:!1,timeoutID:void 0}));else{var f=m.ast,b=new(se(r))(f);if(E=b.nextReduction,b.nextReduction instanceof h.None)return i.pop(),i.push({ast:f,lastReduction:m.lastReduction,step:p,message:"Expression is in normal form.",isNormalForm:!0}),void a(Object(l.a)({},n,{isRunning:!1,timeoutID:void 0}));var v=s.find(function(t){return e.shouldBreak(t,b.nextReduction)});if(void 0!==v)return b.nextReduction instanceof h.Expansion&&v.broken.add(b.nextReduction.target),b.nextReduction instanceof h.Beta&&b.nextReduction.redex.left instanceof h.Lambda&&v.broken.add(b.nextReduction.redex.left.argument),window.clearTimeout(c),void a(Object(l.a)({},n,{isRunning:!1,timeoutID:c}));f=b.perform(),i[i.length-1]={ast:f,lastReduction:E,step:p+1,message:"",isNormalForm:d},a(Object(l.a)({},n,{timeoutID:window.setTimeout(this.onRun,u)}))}}},{key:"onStop",value:function(){var e=this.props,t=e.state,n=e.setBoxState,a=t.timeoutID;window.clearTimeout(a),n(Object(l.a)({},t,{isRunning:!1,timeoutID:void 0}))}},{key:"shouldBreak",value:function(e,t){return t instanceof e.type&&t instanceof h.Beta&&e.context instanceof h.Variable&&t.redex.left instanceof h.Lambda&&t.redex.left.argument.identifier===e.context.identifier&&!e.broken.has(t.redex.left.argument)||(t instanceof e.type&&t instanceof h.Expansion&&e.context instanceof h.ChurchNumeral&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)||t instanceof e.type&&t instanceof h.Expansion&&e.context instanceof h.Macro&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target))}},{key:"parseExpression",value:function(e){var t=this.props.macroTable,n=this.props.state.singleLetterNames,a=Object(h.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:n});return Object(h.parse)(a,t)}}]),t}(a.PureComponent);function le(e){var t=e.state,n=e.setBoxState,i=t.macroName,o=t.macroExpression,s=t.singleLetterNames,c=t.editor,u=c.content,m=c.caretPosition,d=c.placeholder,p=c.syntaxError,E=Object(a.useContext)(ee);return""===i&&""===o?r.a.createElement("div",{className:"box boxMacro inactiveBox"},r.a.createElement(D,{placeholder:d,content:u,caretPosition:m,syntaxError:p,isMarkDown:!1,onContent:function(t,a){n(Object(l.a)({},e.state,{editor:Object(l.a)({},e.state.editor,{content:t,caretPosition:a,syntaxError:null})}))},onEnter:function(){var e=u.split(":=").map(v),a=Object(C.a)(e,2),r=a[0],i=a[1];r in h.builtinMacros?n(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro name is not valid. It redefines built-in Macro.")})})):function(e,t){try{var n=ue(e,t);return n instanceof h.Variable}catch(a){return!1}}(r,s)?function(e,t){try{return ue(e,t),!0}catch(n){return!1}}(i,s)?(n(Object(l.a)({},t,{macroName:r,macroExpression:i})),E(r,i)):n(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro expression is not valid.")})})):n(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro name is not valid.\n            ".concat(s&&1!==r.length?"Name should be single letter.":""))})}))},onExecute:function(){}})):r.a.createElement("div",{className:"box boxMacro"},i," := ",o)}function ue(e,t){var n=t,a=Object(h.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:n});return Object(h.parse)(a,{})}n(188);var me=n(105);function de(e){var t=e.state,n=t.note,i=t.editor,o=i.placeholder,s=i.content,c=i.caretPosition,u=i.syntaxError,m=t.isEditing,d=e.isActive,p=Object(a.useContext)(fe),E=Object(a.useContext)(he),f=function(){E(Object(l.a)({},e.state,{note:s,isEditing:!1}))};return m&&d?r.a.createElement("div",{className:"box boxNoteEditor"},r.a.createElement(D,{placeholder:o,content:s,caretPosition:c,syntaxError:u,isMarkDown:!0,onContent:function(t,n){E(Object(l.a)({},e.state,{editor:Object(l.a)({},e.state.editor,{content:t,caretPosition:n,syntaxError:null})}))},onEnter:f,onExecute:function(){}}),r.a.createElement("div",{id:"controls"},r.a.createElement("button",{onClick:function(){return f()}},"Save"))):r.a.createElement("div",{className:"box boxNote markdown-body"},r.a.createElement(me,{source:n}),r.a.createElement("div",{id:"controls"},r.a.createElement("button",{onClick:function(){E(Object(l.a)({},e.state,{isEditing:!0})),p()}},"Edit")))}function pe(e){var t=e.state,n=e.isActive,a=t.type;return a===j.EXPRESSION?r.a.createElement("div",{className:""},r.a.createElement(ve.Consumer,null,function(e){return r.a.createElement(he.Consumer,null,function(a){return r.a.createElement(ce,{state:t,isActive:n,macroTable:e,setBoxState:a})})})):a===j.MACRO?r.a.createElement("div",{className:""},r.a.createElement(he.Consumer,null,function(e){return r.a.createElement(le,{state:t,setBoxState:e})})):a===j.NOTE?r.a.createElement("div",{className:""},r.a.createElement(de,{state:t,isActive:n})):null}function Ee(){var e=Object(a.useContext)(q),t=Object(a.useContext)(K),n=Object(a.useContext)(W);return r.a.createElement("div",{className:"emptyC"},r.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return n(function(e,t){return{type:j.EXPRESSION,__key:Date.now().toString(),expression:"",ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:!1,strategy:e,singleLetterNames:t,editor:{placeholder:O.INIT,content:"",caretPosition:0,syntaxError:null}}}(e,t))}},r.a.createElement("i",null,"+ \u03bb")),r.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return n(function(e){return{type:j.MACRO,__key:Date.now().toString(),macroName:"",macroExpression:"",singleLetterNames:e,editor:{placeholder:O.MACRO,content:"",caretPosition:0,syntaxError:null}}}(t))}},r.a.createElement("i",null,"+ Macro")),r.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return n({type:j.NOTE,__key:Date.now().toString(),note:"",isEditing:!0,editor:{placeholder:O.NOTE,content:"",caretPosition:0,syntaxError:null}})}},r.a.createElement("i",null,"+ MD")))}var fe=Object(a.createContext)(function(){}),he=Object(a.createContext)(function(e){});function be(e){var t=e.submittedBoxes,n=e.activeBoxIndex,i=Object(a.useContext)($),o=Object(a.useContext)(Z);return 0===t.length?r.a.createElement("div",{className:"evaluatorSpace"},r.a.createElement("div",{className:"bigEmpty"},r.a.createElement(Ee,null))):r.a.createElement("div",{className:"evaluatorSpace"},r.a.createElement("ul",{className:"evaluatorList UL"},t.map(function(e,t){return r.a.createElement("li",{className:"LI",key:e.__key},r.a.createElement(fe.Provider,{value:function(){return i(t)}},r.a.createElement(he.Provider,{value:function(e){return o(t,e)}},r.a.createElement(pe,{state:e,isActive:t===n}))))}),r.a.createElement("div",{className:"smallEmpty"},r.a.createElement(Ee,null))))}var ve=Object(a.createContext)(Object(l.a)({},N,b()));function xe(e){var t=Object(a.useContext)(X),n=t.macroTable,i=t.submittedBoxes,o=t.activeBoxIndex;return r.a.createElement(ve.Provider,{value:n},r.a.createElement(be,{submittedBoxes:i,activeBoxIndex:o}))}var ge=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).setBoxState=n.setBoxState.bind(Object(f.a)(Object(f.a)(n))),n.addEmptyBox=n.addEmptyBox.bind(Object(f.a)(Object(f.a)(n))),n.changeActiveBox=n.changeActiveBox.bind(Object(f.a)(Object(f.a)(n))),n.changeActiveStrategy=n.changeActiveStrategy.bind(Object(f.a)(Object(f.a)(n))),n.changeActiveSingleLetterNames=n.changeActiveSingleLetterNames.bind(Object(f.a)(Object(f.a)(n))),n.getActiveStrategy=n.getActiveStrategy.bind(Object(f.a)(Object(f.a)(n))),n.getActiveSingleLetterNames=n.getActiveSingleLetterNames.bind(Object(f.a)(Object(f.a)(n))),n.addBox=n.addBox.bind(Object(f.a)(Object(f.a)(n))),n.removeMacro=n.removeMacro.bind(Object(f.a)(Object(f.a)(n))),n.defineMacro=n.defineMacro.bind(Object(f.a)(Object(f.a)(n))),n.createBoxFromURL=n.createBoxFromURL.bind(Object(f.a)(Object(f.a)(n))),n.state=k,window.addEventListener("hashchange",n.createBoxFromURL),n}return Object(E.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.createBoxFromURL()}},{key:"render",value:function(){var e=this,t=this.state,n=t.macroTable,a=t.screen;return r.a.createElement("div",{className:"app"},r.a.createElement(I,{state:this.state,onImport:function(t){return e.setState(t)},onScreenChange:function(t){return e.setState(Object(l.a)({},e.state,{screen:t}))}}),r.a.createElement(T,{getActiveSingleLetterNames:this.getActiveSingleLetterNames,getActiveStrategy:this.getActiveStrategy,changeActiveSingleLetterNames:this.changeActiveSingleLetterNames,changeActiveStrategy:this.changeActiveStrategy}),a===g.main?r.a.createElement(G,{SLI:this.getActiveSingleLetterNames(),strategy:this.getActiveStrategy(),state:this.state},r.a.createElement(te,{addBox:this.addBox,addEmptyBox:this.addEmptyBox,changeActiveBox:this.changeActiveBox,defineMacro:this.defineMacro,setBoxState:this.setBoxState},r.a.createElement(xe,null))):r.a.createElement(R,{macroTable:n,removeMacro:this.removeMacro}))}},{key:"createBoxFromURL",value:function(){var e=decodeURI(window.location.hash.substring(1)),t=-1!==e.indexOf("exercise:"),n=t?e.substring(9):e;if(""!==n){var a={type:j.EXPRESSION,__key:Date.now().toString(),expression:"",ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:t,strategy:this.getActiveStrategy(),singleLetterNames:this.getActiveSingleLetterNames(),editor:{placeholder:O.INIT,content:n,caretPosition:n.length,syntaxError:null}};this.setState(Object(l.a)({},this.state,{submittedBoxes:[a],activeBoxIndex:0}))}}},{key:"setBoxState",value:function(e,t){var n=this.state.submittedBoxes,a=t.editor.content||t.expression,r=t.type===j.EXPRESSION&&t.isExercise?"exercise:":"";history.pushState({},"page title?","#"+r+encodeURI(a)),n[e]=t,this.setState(Object(l.a)({},this.state,{submittedBoxes:n}))}},{key:"addEmptyBox",value:function(e){var t=this.state.submittedBoxes;this.setState(Object(l.a)({},this.state,{submittedBoxes:[].concat(Object(c.a)(t),[e]),activeBoxIndex:Math.max(0,t.length)}))}},{key:"addBox",value:function(e){var t=this.state.submittedBoxes;this.setState(Object(l.a)({},this.state,{submittedBoxes:[].concat(Object(c.a)(t),[e]),activeBoxIndex:t.length}))}},{key:"changeActiveBox",value:function(e){this.setState(Object(l.a)({},this.state,{activeBoxIndex:e}))}},{key:"getActiveStrategy",value:function(){var e=this.state,t=e.submittedBoxes,n=e.activeBoxIndex;if(-1===n)return JSON.parse(window.localStorage.getItem("strategy")||JSON.stringify(x.NORMAL));var a=t[n];return a.type!==j.EXPRESSION?JSON.parse(window.localStorage.getItem("strategy")||JSON.stringify(x.NORMAL)):a.strategy}},{key:"getActiveSingleLetterNames",value:function(){var e=this.state,t=e.submittedBoxes,n=e.activeBoxIndex;if(-1===n)return JSON.parse(window.localStorage.getItem("SLI")||"true");var a=t[n];return a.type===j.NOTE?JSON.parse(window.localStorage.getItem("SLI")||"true"):a.type===j.EXPRESSION?a.singleLetterNames:a.type===j.MACRO?a.singleLetterNames:JSON.parse(window.localStorage.getItem("SLI")||"true")}},{key:"changeActiveStrategy",value:function(e){var t=this.state,n=t.submittedBoxes,a=t.activeBoxIndex;n[a]=Object(l.a)({},n[a],{strategy:e}),this.setState(Object(l.a)({},this.state)),window.localStorage.setItem("strategy",JSON.stringify(e))}},{key:"changeActiveSingleLetterNames",value:function(e){var t=this.state,n=t.submittedBoxes,a=t.activeBoxIndex;n[a]=Object(l.a)({},n[a],{singleLetterNames:e}),this.setState(Object(l.a)({},this.state)),window.localStorage.setItem("SLI",JSON.stringify(e))}},{key:"removeMacro",value:function(e){var t=this.state.macroTable,n=Object(l.a)({},t);delete n[e],this.setState(Object(l.a)({},this.state,{macroTable:n})),S(n)}},{key:"defineMacro",value:function(e,t){var n=this.state.macroTable;this.setState(Object(l.a)({},this.state,{macroTable:Object(l.a)({},n,Object(s.a)({},e,t))})),S(Object(l.a)({},n,Object(s.a)({},e,t)))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},57:function(e,t,n){e.exports=n(189)},63:function(e,t,n){},64:function(e,t,n){},99:function(e,t,n){}},[[57,1,2]]]);
//# sourceMappingURL=main.dd819cb9.chunk.js.map