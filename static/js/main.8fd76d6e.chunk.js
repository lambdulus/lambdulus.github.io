(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(82)},43:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(35),o=n.n(s),r=(n(43),n(24)),c=n(12),l=n(4),u=n(15),p=n(14),d=n(11),m=n(19),f=n(17),h=n(18),b=n(2),E=n(1);n(76),n(77);function v(e){var t=e.placeholder,n=e.expression,a=e.caretPosition,s=e.onExpression,o=e.onEnter,r=e.syntaxError,c=n.split("\n").length;return i.a.createElement("div",{className:"editorContainer"},r?"".concat(r):null,i.a.createElement("div",{className:"editor"},i.a.createElement(x,{placeholder:t,expression:n,lines:c,caretPosition:a,onChange:function(e){var t=e.target.value,n=e.target.selectionEnd;t=t.replace(/\\/g,"\u03bb"),s(t,n)},onKeyDown:function(e){e.shiftKey||"Enter"!==e.key||(e.preventDefault(),o())}})))}function x(e){var t=e.placeholder,n=e.expression,a=e.lines,s=e.onChange,o=e.onKeyDown,r=e.caretPosition;return i.a.createElement("textarea",{className:"prompt",onKeyDown:o,onChange:s,value:n,placeholder:t,wrap:"hard",autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,rows:Math.max(a,1),ref:function(e){null!==e&&(e.selectionStart=r,e.selectionEnd=r,e.focus())}})}function S(e){return e.trim()}var N={FACT:"(Y (\u03bb f n . (<= n 1) 1 (* n (f (- n 1)))))",FACCT:"(\u03bb n . (Y (\u03bb f n a . IF (= n 1) a (f (- n 1) (* n a)))) (- n 1) (n))",FIB:"(Y (\u03bb f n . (= n 0) 0 ((= n 1) 1 ( + (f (- n 1)) (f (- n 2))))))",APPEND:"Y (\u03bb fn listA listB . IF (NULL listA) (listB) (CONS (FIRST listA) (fn (SECOND listA) listB)))",LISTGREQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (>= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTLESS:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (< (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTGR:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (> (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTEQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",QUICKSORT:"Y (\u03bb fn list . IF (NULL list) (NIL) ( IF (NULL (SECOND list)) (list) ( APPEND (fn (LISTLESS (FIRST list) list)) ( APPEND (LISTEQ (FIRST list) list) (fn (LISTGR (FIRST list) list)) ) ) ) )",INFLIST:"(\u03bb n . (Y (\u03bb x . (\u03bb f s g . g f s) n x)))",REMOVENTH:"Y (\u03bb fn list n . IF (= n 0) (SECOND list) (IF (NULL list) NIL (CONS (FIRST list) (fn (SECOND list) (- n 1) ) ) ) )",NTH:"Y (\u03bb fn list n . IF (= n 0) (FIRST list) (IF (NULL (list)) NIL (fn (SECOND list) (- n 1)) ) )",LEN:"Y (\u03bb fn list . IF (NULL list) (0) (+ 1 (fn (SECOND list) )) )",GETNTH:"(\u03bb end . (Y (\u03bb f n i . (end i) (i) ( (= n 0) (Y (\u03bb f a . (end a) (i) (f) ) ) (f (- n 1)) ) )) )",MAP:"(\u03bb fn l . (Y (\u03bb f it . IF (NULL it) (NIL) (CONS (fn (FIRST it)) (f (SECOND it))) )) l )",REDUCE:"(\u03bb fn l init . Y (\u03bb f it acc . IF (NULL it) (acc) (f (SECOND it) (fn (FIRST it) acc)) ) l init )",APPLY:"(\u03bb f args . Y (\u03bb ff f l . (NULL l) (f) (ff (f (FIRST l)) (SECOND l)) ) f args )",RANGE:"(\u03bb m n . Y (\u03bb f e . (= e n) (CONS e NIL) (CONS e (f (+ e 1))) ) m )",LISTCOMPR:"(\u03bb args . APPLY (\u03bb op in rng cond . Y (\u03bb f l . (NULL l) (NIL) ( (cond (FIRST l)) (CONS (op (FIRST l)) (f (SECOND l))) (CONS (FIRST l) (f (SECOND l))) ) ) rng ) args )",MOD:"(\u03bb n m . (n (\u03bb n . (= n (- m 1)) (0) (+ n 1)) (0)) )",INFIX:"APPLY (\u03bb l op r . op l r)"};function O(){return decodeURI(window.location.hash.substring(1))}n(78),n(79),n(80);function k(e){e.onRun,e.onStop,e.onStep,e.onClear,e.isRunning;var t=e.isActive,n=e.makeActive,a=e.isExercise,s=e.makeExercise,o=e.endExercise;return i.a.createElement("div",{id:"controls"},t?i.a.createElement("div",{className:"badge"},"active"):i.a.createElement("div",{className:"badge makeBadge",onClick:n},"make active"),a?i.a.createElement("div",{className:"badge makeBadge",onClick:o},"end exercise"):i.a.createElement("div",{className:"badge makeBadge",onClick:s},"make exercise"))}n(81);var R=function(e){function t(e,n,a,i){var s;return Object(p.a)(this,t),(s=Object(m.a)(this,Object(f.a)(t).call(this))).tree=e,s.onClick=n,s.redex=a,s.breakpoints=i,s.rendered=null,s.tree.visit(Object(b.a)(Object(b.a)(s))),s}return Object(h.a)(t,e),Object(d.a)(t,[{key:"printMultiLambda",value:function(e,t){var n=this;if(e.body instanceof E.Lambda){var a=e.body.argument,s="argument";this.isBreakpoint(e.body.argument)&&(s+=" breakpoint");var o=i.a.createElement("span",{className:"arguments"},t," "," ",i.a.createElement("span",{className:s,onClick:function(){return n.onClick({type:E.Beta,context:a,broken:new Set})}},e.body.argument.name()));this.printMultiLambda(e.body,o)}else{e.body.visit(this);var r=this.rendered;this.rendered=t,this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda",onClick:function(){n.onClick({type:E.Beta,context:e,broken:new Set})}},"\u03bb "," "),t," . ",r,")")}}},{key:"isBreakpoint",value:function(e){var t=!0,n=!1,a=void 0;try{for(var i,s=this.breakpoints[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){if(i.value.context.identifier===e.identifier)return!0}}catch(o){n=!0,a=o}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}return!1}}]),Object(d.a)(t,[{key:"print",value:function(){return this.rendered}},{key:"onApplication",value:function(e){var t="left",n="right";if(null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(t+=" redex",n+=" redex"),e.right instanceof E.Application){e.left.visit(this);var a=i.a.createElement("span",{className:t},this.rendered);e.right.visit(this);var s=i.a.createElement("span",{className:n},"( ",this.rendered," )");this.rendered=i.a.createElement("span",{className:"application"},a," ",s)}else{e.left.visit(this);var o=i.a.createElement("span",{className:t},this.rendered);e.right.visit(this);var r=i.a.createElement("span",{className:n},this.rendered);this.rendered=i.a.createElement("span",{className:"application"},o," ",r)}}},{key:"onLambda",value:function(e){var t=this;if(e.body instanceof E.Lambda){var n=e.argument,a="argument";this.isBreakpoint(e.argument)&&(a+=" breakpoint");var s=i.a.createElement("span",{className:a,onClick:function(){return t.onClick({type:E.Beta,context:n,broken:new Set})}},e.argument.name());this.printMultiLambda(e,s)}else{var o=e.argument;e.argument.visit(this);var r=this.rendered;e.body.visit(this);var c=this.rendered,l="argument";this.isBreakpoint(e.argument)&&(l+=" breakpoint"),this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda",onClick:function(){t.onClick({type:E.Beta,context:e,broken:new Set})}},"\u03bb "," "),i.a.createElement("span",{className:l,onClick:function(){return t.onClick({type:E.Beta,context:o,broken:new Set})}},r," "," "),". ",c,")")}}},{key:"onChurchNumeral",value:function(e){var t=this,n="churchnumeral";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(n+=" redex"),this.isBreakpoint(e)&&(n+=" breakpoint"),this.rendered=i.a.createElement("span",{className:n,onClick:function(){return t.onClick({type:E.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onMacro",value:function(e){var t=this,n="macro";null!==this.redex&&this.redex.identifier===e.identifier&&this.redex===e&&(n+=" redex"),this.isBreakpoint(e)&&(n+=" breakpoint"),this.rendered=i.a.createElement("span",{className:n,onClick:function(){return t.onClick({type:E.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onVariable",value:function(e){this.rendered=i.a.createElement("span",{className:"variable"},e.name())}}]),t}(E.ASTVisitor),y=n(29);function g(e){var t=e.lastReduction;return null===t?null:t instanceof E.Beta?i.a.createElement("p",{className:"lastReduction"},"\u03b2 reduction"):t instanceof E.Alpha?i.a.createElement("p",{className:"lastReduction"},"\u03b1 conversion"):t instanceof E.Expansion?i.a.createElement("p",{className:"lastReduction"},"Macro expansion"):t instanceof y.Eta?i.a.createElement("p",{className:"lastReduction"},"\u03b7 conversion"):null}function j(e){var t=e.stepRecord,n=e.addBreakpoint,a=e.breakpoints,s=e.children,o=t.ast,r=t.lastReduction,c=t.step;if(null===o)return null;var l=null,u=new E.NormalEvaluator(o);u.nextReduction instanceof E.Beta&&(l=u.nextReduction.redex),u.nextReduction instanceof E.Expansion&&(l=u.nextReduction.target);var p=new R(o,n,l,a);return i.a.createElement("span",{className:"step"},i.a.createElement(g,{lastReduction:r}),i.a.createElement("div",{className:"inlineblock"},i.a.createElement("p",{className:"stepNumber"},c," :"),p.print(),s))}var I,L=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).onClear=n.onClear.bind(Object(b.a)(Object(b.a)(n))),n.onStep=n.onStep.bind(Object(b.a)(Object(b.a)(n))),n.onRun=n.onRun.bind(Object(b.a)(Object(b.a)(n))),n.__onRun=n.__onRun.bind(Object(b.a)(Object(b.a)(n))),n.onStop=n.onStop.bind(Object(b.a)(Object(b.a)(n))),n.shouldBreak=n.shouldBreak.bind(Object(b.a)(Object(b.a)(n))),n.addBreakpoint=n.addBreakpoint.bind(Object(b.a)(Object(b.a)(n))),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.state,a=(t.updateState,n.history),s=(n.steps,n.isRunning),o=(n.lastReduction,n.breakpoints),r=(n.timeoutID,n.isExercise);return i.a.createElement("div",{className:"box boxEval"},i.a.createElement("ul",null,function(e,t,n,a){for(var i=new Array(t-e+1),s=0,o=e;o<=t;++o)i[s++]=a(n[o],o);return i}(0,a.length-2,a,function(t,n){return i.a.createElement("li",{key:n,className:"inactiveStep"},i.a.createElement(j,{breakpoints:o,addBreakpoint:function(){},stepRecord:t},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(t.ast)}})))}),i.a.createElement("li",{key:a.length-1,className:"activeStep"},i.a.createElement(j,{breakpoints:o,addBreakpoint:this.addBreakpoint,stepRecord:a[a.length-1]},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.editExpression(a[a.length-1].ast)}})))),i.a.createElement(k,{onRun:this.onRun,onStop:this.onStop,onStep:this.onStep,onClear:this.onClear,isRunning:s,isActive:this.props.isActive,makeActive:this.props.makeActive,isExercise:r,makeExercise:function(){return e.props.updateState({isExercise:!0})},endExercise:function(){return e.props.updateState({isExercise:!1})}}))}},{key:"onRun",value:function(){var e=this.props,t=e.state,n=e.updateState,a=t.lastReduction,i=t.timeout;a instanceof E.None||n({isRunning:!0,timeoutID:window.setTimeout(this.__onRun,i)})}},{key:"__onRun",value:function(){var e=this,t=this.props,n=t.state,a=t.updateState,i=n.history,s=n.steps,o=n.lastReduction,r=n.isRunning,c=n.breakpoints,l=n.timeoutID,u=n.timeout;if(r)if(o instanceof E.None)a({isRunning:!1,timeoutID:void 0});else{var p=i[i.length-1].step,d=i[i.length-1].ast,m=new E.NormalEvaluator(d);if(o=m.nextReduction,m.nextReduction instanceof E.None)a({history:i=[{ast:d,lastReduction:o,step:p}],steps:s,lastReduction:o,isRunning:!1,timeoutID:void 0});else{var f=c.find(function(t,n){return n,e.shouldBreak(t,m.nextReduction)});if(void 0!==f)return m.nextReduction instanceof E.Expansion&&f.broken.add(m.nextReduction.target),window.clearTimeout(l),a({isRunning:!1,breakpoints:c,timeoutID:void 0}),void console.log("NEMENIM AST");a({history:[{ast:d=m.perform(),lastReduction:o,step:p}],steps:++s,lastReduction:o,timeoutID:window.setTimeout(this.__onRun,u)})}}}},{key:"onStop",value:function(){var e=this.props,t=e.updateState,n=e.state.timeoutID;window.clearTimeout(n),t({isRunning:!1,timeoutID:void 0})}},{key:"onStep",value:function(){var e=this.props,t=e.state,n=e.updateState,a=t.history,i=t.steps,s=t.lastReduction;if(!(s instanceof E.None)){var o=a[a.length-1].ast.clone(),r=new E.NormalEvaluator(o);s=r.nextReduction,r.nextReduction instanceof E.None?n({lastReduction:s}):(o=r.perform(),i++,n({history:[].concat(Object(c.a)(a),[{ast:o,lastReduction:s,step:i}]),steps:i,lastReduction:s}))}}},{key:"onClear",value:function(){var e=this.props,t=e.state;(0,e.updateState)({history:[{ast:t.ast.clone(),lastReduction:E.None,step:0}],steps:0,isRunning:!1,lastReduction:null,breakpoints:[]})}},{key:"addBreakpoint",value:function(e){var t=this.props,n=t.state;(0,t.updateState)({breakpoints:[].concat(Object(c.a)(n.breakpoints),[e])})}},{key:"shouldBreak",value:function(e,t){return t instanceof e.type&&t instanceof E.Beta&&e.context instanceof E.Lambda&&t.target.identifier===e.context.body.identifier||(t instanceof e.type&&t instanceof E.Beta&&e.context instanceof E.Variable&&t.redex.left instanceof E.Lambda&&t.redex.left.argument.identifier===e.context.identifier||(t instanceof e.type&&t instanceof E.Expansion&&e.context instanceof E.ChurchNumeral&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)||t instanceof e.type&&t instanceof E.Expansion&&e.context instanceof E.Macro&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)))}}]),t}(a.PureComponent);function C(e){var t=e.state,n=t.macroName,a=t.macroExpression;return i.a.createElement("div",{className:"box boxMacro"},n," := ",a)}function T(e){var t=e.state.note;return i.a.createElement("div",{className:"box boxNote"},t)}function w(e){var t=e.state,n=e.updateState,a=e.isActive,s=t.type;return s===I.expression?i.a.createElement("div",{className:""},i.a.createElement(L,{state:t,updateState:n,editExpression:e.editExpression,isActive:a,makeActive:e.makeActive})):s===I.macro?i.a.createElement("div",{className:""},i.a.createElement(C,{state:t})):s===I.note?i.a.createElement("div",{className:""},i.a.createElement(T,{state:t})):i.a.createElement("div",null,"I do not know what to do with this yet.")}function D(e){var t=e.state,n=e.onImport,a=e.onScreenChange,s=t.screen,o=function(e){return Object(l.a)({},e,{submittedExpressions:e.submittedExpressions.map(A)})}(t),r=function(e){var t=new Blob([e],{type:"application/json"});return window.URL.createObjectURL(t)}(JSON.stringify(o));return i.a.createElement("div",{id:"topbar"},i.a.createElement("div",null,i.a.createElement("i",{id:"notebooks",className:"icon fas fa-book-open fa-2x"}),i.a.createElement("p",{className:"iconLabel"},"Notebooks")),i.a.createElement("div",null,s===U.main?i.a.createElement("i",{className:"icon fas fa-list-ul fa-2x",onClick:function(){return a(U.macrolist)}}):i.a.createElement("i",{className:"icon far fa-window-close fa-2x",onClick:function(){return a(U.main)}}),i.a.createElement("p",{className:"iconLabel"},"Macros")),i.a.createElement("div",null,i.a.createElement("a",{className:"export",href:r,download:"notebook_lambdulus.json",onClick:function(){return setTimeout(function(){return window.URL.revokeObjectURL(r)},10)}},i.a.createElement("i",{id:"download",className:"icon fas fa-cloud-download-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Export")),i.a.createElement("div",null,i.a.createElement("input",{type:"file",accept:"application/json",id:"input",onChange:function(e){return function(e,t){var n=e.target.files;if(null===n)return;var a=n[0],i=new FileReader;i.onload=function(e){var n=JSON.parse(i.result);t(function(e){var t=e.singleLetterVars,n=e.macroTable,a={singleLetterVars:t,macroTable:n};return Object(l.a)({},e,{submittedExpressions:e.submittedExpressions.map(function(e){return function(e,t){if(e.type===I.expression){var n=function(e,t){var n=t.singleLetterVars,a=t.macroTable,i=Object(E.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:n});return Object(E.parse)(i,a)}(e.expression,t);return Object(l.a)({},e,{ast:n,history:[{ast:n,lastReduction:E.None,step:0}]})}return e}(e,a)})})}(n))},i.readAsText(a)}(e,n)}}),i.a.createElement("label",{htmlFor:"input"},i.a.createElement("i",{className:"icon fas fa-cloud-upload-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Import")))}function A(e){return e.type===I.expression?Object(l.a)({},e,{ast:null,history:[],isRunning:!1,lastReduction:null,breakpoints:[],timeoutID:void 0}):e}function F(e){var t=e.submittedExpressions,n=e.updateState,a=e.removeExpression,s=e.activeBox,o=e.makeActive;return i.a.createElement("div",{className:"evaluatorSpace"},t.length?i.a.createElement("ul",{className:"evaluatorList"},t.map(function(t,r){return i.a.createElement("li",{key:t.__key},i.a.createElement(w,{state:t,updateState:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return n(e,r)}),removeExpression:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return a(r)}),editExpression:e.editExpression,isActive:r===s,makeActive:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return o(r)})}))})):null)}function B(e){var t=e.macroTable,n=e.removeMacro;return i.a.createElement("div",{className:"macroSpace"},i.a.createElement("p",null,"Built-in Macros"),i.a.createElement("ul",null,Object.entries(E.builtinMacros).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return i.a.createElement("div",{key:n},i.a.createElement("li",null,i.a.createElement("div",{className:"box boxMacro"},n," := ",a)))})),i.a.createElement("p",null,"User-defined Macros"),i.a.createElement("ul",null,Object.entries(t).map(function(e){var t=Object(u.a)(e,2),a=t[0],s=t[1];return i.a.createElement("div",{key:a},i.a.createElement("li",null,i.a.createElement("div",{className:"box boxMacro"},a," := ",s,i.a.createElement("i",{className:"hiddenMacroIcon far fa-trash-alt",onClick:function(){return n(a)}}))))})))}!function(e){e[e.expression=0]="expression",e[e.macro=1]="macro",e[e.note=2]="note"}(I||(I={}));var U,M,P=n(36),Y=function(){function e(t){Object(p.a)(this,e),this.roots=t,this.translator=new Map,this.equals=!0,this.context=void 0;var n=t,a=Object(P.a)(n);this.context=a.slice(0),this.compare()}return Object(d.a)(e,[{key:"compare",value:function(){var e=Object(u.a)(this.context,2),t=e[0],n=e[1];if(t instanceof E.Lambda&&n instanceof E.Lambda){var a=new Map(this.translator.entries());this.translator.set(t.argument.name(),n.argument.name()),this.context=[t.right,n.right],this.compare(),this.translator=a}else if(t instanceof E.Application&&n instanceof E.Application){if(this.context=[t.left,n.left],this.compare(),!this.equals)return;this.context=[t.right,n.right],this.compare()}else t instanceof E.Macro&&n instanceof E.Macro?this.equals=t.name()===n.name():t instanceof E.ChurchNumeral&&n instanceof E.ChurchNumeral?this.equals=t.name()===n.name():t instanceof E.Variable&&n instanceof E.Variable?this.equals=this.translator.get(t.name())===n.name():this.equals=!1}}]),e}();!function(e){e[e.main=0]="main",e[e.macrolist=1]="macrolist",e[e.notebooks=2]="notebooks"}(U||(U={})),function(e){e.INIT="type \u03bb expression",e.EVAL_MODE="HIT ENTER AGAIN FOR NEXT STEP",e.VALIDATE_MODE="HIT ENTER TO VALIDATE YOUR SKILL"}(M||(M={}));var _=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).parseExpression=n.parseExpression.bind(Object(b.a)(Object(b.a)(n))),n.updateFromURL=n.updateFromURL.bind(Object(b.a)(Object(b.a)(n)));var a=function(e,t){var n;return[function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];window.clearTimeout(n),n=window.setTimeout(function(){e.apply(void 0,i)},t)},function(){window.clearTimeout(n)}]}(n.updateURL.bind(Object(b.a)(Object(b.a)(n))),500),i=Object(u.a)(a,2),s=i[0],o=i[1];n.updateURL=s,n.cancelUpdate=o,n.onExpression=n.onExpression.bind(Object(b.a)(Object(b.a)(n))),n.onSubmit=n.onSubmit.bind(Object(b.a)(Object(b.a)(n))),n.onRemoveExpression=n.onRemoveExpression.bind(Object(b.a)(Object(b.a)(n))),n.updateMacros=n.updateMacros.bind(Object(b.a)(Object(b.a)(n))),n.onUpdateEvaluationState=n.onUpdateEvaluationState.bind(Object(b.a)(Object(b.a)(n))),n.onRemoveMacro=n.onRemoveMacro.bind(Object(b.a)(Object(b.a)(n))),n.onEnter=n.onEnter.bind(Object(b.a)(Object(b.a)(n))),n.onStep=n.onStep.bind(Object(b.a)(Object(b.a)(n))),n.onRemoveLastStep=n.onRemoveLastStep.bind(Object(b.a)(Object(b.a)(n))),n.onExerciseStep=n.onExerciseStep.bind(Object(b.a)(Object(b.a)(n))),window.addEventListener("hashchange",n.updateFromURL);var r=O();return n.state={editorState:{placeholder:M.INIT,expression:r,caretPosition:r.length,syntaxError:null},singleLetterVars:!1,macroTable:Object(l.a)({},N,JSON.parse(window.localStorage.getItem("macrotable")||"{}")),submittedExpressions:[],screen:U.main,activeBox:-1},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.editorState,a=n.expression,s=n.caretPosition,o=n.syntaxError,r=n.placeholder,c=(t.singleLetterVars,t.macroTable),u=t.submittedExpressions,p=t.screen,d=t.activeBox,m=i.a.createElement("div",null,"Notebooks are not implemented yet.");return i.a.createElement("div",{className:"app"},i.a.createElement(D,{state:this.state,onImport:function(t){return e.setState(t)},onScreenChange:function(t){return e.setState(Object(l.a)({},e.state,{screen:t}))}}),p===U.main?i.a.createElement(F,{removeExpression:e.onRemoveExpression,updateState:e.onUpdateEvaluationState,submittedExpressions:u,editExpression:function(t){return e.setState(Object(l.a)({},e.state,{editorState:{placeholder:M.INIT,expression:t.toString(),caretPosition:t.toString().length,syntaxError:null}}))},activeBox:d,makeActive:function(t){return e.setState(Object(l.a)({},e.state,{activeBox:t}))}}):p===U.macrolist?i.a.createElement(B,{macroTable:c,removeMacro:e.onRemoveMacro}):m,i.a.createElement(v,{placeholder:r,expression:a,caretPosition:s,onExpression:this.onExpression,onEnter:this.onEnter,syntaxError:o}))}},{key:"updateURL",value:function(e){history.pushState({},"page title?","#"+encodeURI(e))}},{key:"cancelUpdate",value:function(){}},{key:"onExpression",value:function(e,t){this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:e,caretPosition:t,syntaxError:null}})),this.updateURL(e)}},{key:"onUpdateEvaluationState",value:function(e,t){var n=this.state.submittedExpressions;n[t]=Object(l.a)({},n[t],e),this.setState(Object(l.a)({},this.state,{submittedExpressions:n}))}},{key:"onRemoveExpression",value:function(){}},{key:"onRemoveLastStep",value:function(){console.log("CURRENTLY NOT IMPEMENTED")}},{key:"onEnter",value:function(){var e=this.state,t=e.editorState.expression,n=e.submittedExpressions,a=n[n.length-1];void 0!==a&&a.isExercise?this.onExerciseStep():t.length||void 0===a||a.type!==I.expression?this.onSubmit():this.onStep()}},{key:"onExerciseStep",value:function(){console.log("VALIDATE MY EXP");var e=this.state.editorState.expression;try{var t=this.parseExpression(e),n=this.state,a=n.submittedExpressions,i=n.activeBox,s=a[i],o=s.history,r=s.steps,u=s.lastReduction;if(u instanceof E.None)return;var p=o[o.length-1].ast.clone(),d=new E.NormalEvaluator(p);if(u=d.nextReduction,d.nextReduction instanceof E.None)return a[i]=Object(l.a)({},s,{lastReduction:u}),void this.setState(Object(l.a)({},this.state,{submittedExpressions:a}));p=d.perform(),r++,new Y([t,p]).equals?p=t:console.log("Incorrect step"),a[i]=Object(l.a)({},s,{history:[].concat(Object(c.a)(o),[{ast:p,lastReduction:u,step:r}]),steps:r,lastReduction:u}),this.setState(Object(l.a)({},this.state,{editorState:Object(l.a)({},this.state.editorState,{expression:"",caretPosition:0,placeholder:M.VALIDATE_MODE,syntaxError:null}),submittedExpressions:a}))}catch(m){this.onSubmit()}}},{key:"onStep",value:function(){var e=this.state,t=e.submittedExpressions,n=e.activeBox,a=t[n],i=a.history,s=a.steps,o=a.lastReduction;if(!(o instanceof E.None)){var r=i[i.length-1].ast.clone(),u=new E.NormalEvaluator(r);if(o=u.nextReduction,u.nextReduction instanceof E.None)return t[n]=Object(l.a)({},a,{lastReduction:o}),void this.setState(Object(l.a)({},this.state,{submittedExpressions:t}));r=u.perform(),s++,t[n]=Object(l.a)({},a,{history:[].concat(Object(c.a)(i),[{ast:r,lastReduction:o,step:s}]),steps:s,lastReduction:o}),this.setState(Object(l.a)({},this.state,{submittedExpressions:t}))}}},{key:"onSubmit",value:function(){this.cancelUpdate();var e=this.state,t=e.editorState,n=t.expression,a=t.caretPosition,i=e.submittedExpressions,s=e.macroTable,o=e.activeBox;if(history.pushState({},"","#"+encodeURI(n)),function(e){try{return e.indexOf(":=")>0}catch(t){return!1}}(n)){history.pushState({},"","#"+encodeURI(""));var p=n.split(":=").map(S),d=Object(u.a)(p,2),m=d[0],f=d[1],h={type:I.macro,__key:Date.now().toString(),macroName:m,macroExpression:f},b=Object(l.a)({},s,Object(r.a)({},m,f));this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null},submittedExpressions:[].concat(Object(c.a)(i),[h]),macroTable:b,activeBox:o+1})),this.updateMacros(b)}else if(function(e){return 0===e.indexOf("#")}(n)){history.pushState({},"","#"+encodeURI(""));var v={type:I.note,__key:Date.now().toString(),note:n.substring(1)};this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:"",caretPosition:0,syntaxError:null},submittedExpressions:[].concat(Object(c.a)(i),[v]),activeBox:o+1}))}else try{var x=this.parseExpression(n);history.pushState({},"","#"+encodeURI(""));var N={type:I.expression,__key:Date.now().toString(),expression:n,ast:x,history:[{ast:x.clone(),lastReduction:E.None,step:0}],steps:0,isRunning:!1,lastReduction:null,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:!1};this.setState(Object(l.a)({},this.state,{editorState:{placeholder:M.EVAL_MODE,expression:"",caretPosition:0,syntaxError:null},submittedExpressions:[].concat(Object(c.a)(i),[N]),activeBox:o+1}))}catch(O){this.updateURL(n),console.log(O),this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:n,caretPosition:a,syntaxError:O}}))}}},{key:"updateFromURL",value:function(){var e=this.state.editorState.expression,t=O();e!==t?this.setState(Object(l.a)({},this.state,{editorState:{placeholder:this.state.editorState.placeholder,expression:t,caretPosition:t.length,syntaxError:null}})):console.log("ALREADY SYNCED")}},{key:"parseExpression",value:function(e){var t=this.state,n=t.singleLetterVars,a=t.macroTable,i=Object(E.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:n});return Object(E.parse)(i,a)}},{key:"onRemoveMacro",value:function(e){var t=this.state.macroTable,n=Object(l.a)({},t);delete n[e],this.setState(Object(l.a)({},this.state,{macroTable:n})),this.updateMacros(n)}},{key:"updateMacros",value:function(e){window.localStorage.setItem("macrotable",JSON.stringify(e))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,1,2]]]);
//# sourceMappingURL=main.8fd76d6e.chunk.js.map