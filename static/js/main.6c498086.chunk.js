(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},103:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(55),o=a.n(r),s=(a(63),a(26)),c=a(19),l=a(2),u=a(12),m=a(11),d=a(16),p=a(14),h=a(15),f=a(3);a(64);function b(e){return e.trim()}var E,v={FACT:"(Y (\u03bb f n . (<= n 1) 1 (* n (f (- n 1)))))",FACCT:"(\u03bb n . (Y (\u03bb f n a . IF (= n 1) a (f (- n 1) (* n a)))) (- n 1) (n))",FIB:"(Y (\u03bb f n . (= n 0) 0 ((= n 1) 1 ( + (f (- n 1)) (f (- n 2))))))",APPEND:"Y (\u03bb fn listA listB . IF (NULL listA) (listB) (CONS (FIRST listA) (fn (SECOND listA) listB)))",LISTGREQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (>= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTLESS:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (< (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTGR:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (> (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",LISTEQ:"Y (\u03bb fn piv list . IF (NULL list) (NIL) ( IF (= (FIRST list) piv) (CONS (FIRST list) (fn piv (SECOND list))) (fn piv (SECOND list)) ) )",QUICKSORT:"Y (\u03bb fn list . IF (NULL list) (NIL) ( IF (NULL (SECOND list)) (list) ( APPEND (fn (LISTLESS (FIRST list) list)) ( APPEND (LISTEQ (FIRST list) list) (fn (LISTGR (FIRST list) list)) ) ) ) )",INFLIST:"(\u03bb n . (Y (\u03bb x . (\u03bb f s g . g f s) n x)))",REMOVENTH:"Y (\u03bb fn list n . IF (= n 0) (SECOND list) (IF (NULL list) NIL (CONS (FIRST list) (fn (SECOND list) (- n 1) ) ) ) )",NTH:"Y (\u03bb fn list n . IF (= n 0) (FIRST list) (IF (NULL (list)) NIL (fn (SECOND list) (- n 1)) ) )",LEN:"Y (\u03bb fn list . IF (NULL list) (0) (+ 1 (fn (SECOND list) )) )",GETNTH:"(\u03bb end . (Y (\u03bb f n i . (end i) (i) ( (= n 0) (Y (\u03bb f a . (end a) (i) (f) ) ) (f (- n 1)) ) )) )",MAP:"(\u03bb fn l . (Y (\u03bb f it . IF (NULL it) (NIL) (CONS (fn (FIRST it)) (f (SECOND it))) )) l )",REDUCE:"(\u03bb fn l init . Y (\u03bb f it acc . IF (NULL it) (acc) (f (SECOND it) (fn (FIRST it) acc)) ) l init )",APPLY:"(\u03bb f args . Y (\u03bb ff f l . (NULL l) (f) (ff (f (FIRST l)) (SECOND l)) ) f args )",RANGE:"(\u03bb m n . Y (\u03bb f e . (= e n) (CONS e NIL) (CONS e (f (+ e 1))) ) m )",LISTCOMPR:"(\u03bb args . APPLY (\u03bb op in rng cond . Y (\u03bb f l . (NULL l) (NIL) ( (cond (FIRST l)) (CONS (op (FIRST l)) (f (SECOND l))) (CONS (FIRST l) (f (SECOND l))) ) ) rng ) args )",MOD:"(\u03bb n m . (n (\u03bb n . (= n (- m 1)) (0) (+ n 1)) (0)) )",INFIX:"APPLY (\u03bb l op r . op l r)"},g=a(1),x=(a(99),a(20)),N=a(56),S=function(){function e(t){Object(u.a)(this,e),this.roots=t,this.translator=new Map,this.equals=!0,this.context=void 0;var a=t,n=Object(N.a)(a);this.context=n.slice(0),this.compare()}return Object(m.a)(e,[{key:"compare",value:function(){var e=Object(x.a)(this.context,2),t=e[0],a=e[1];if(t instanceof g.Lambda&&a instanceof g.Lambda){var n=new Map(this.translator.entries());this.translator.set(t.argument.name(),a.argument.name()),this.context=[t.right,a.right],this.compare(),this.translator=n}else if(t instanceof g.Application&&a instanceof g.Application){if(this.context=[t.left,a.left],this.compare(),!this.equals)return;this.context=[t.right,a.right],this.compare()}else t instanceof g.Macro&&a instanceof g.Macro?this.equals=t.name()===a.name():t instanceof g.ChurchNumeral&&a instanceof g.ChurchNumeral?this.equals=t.name()===a.name():t instanceof g.Variable&&a instanceof g.Variable?this.equals=this.translator.get(t.name())===a.name():this.equals=!1}}]),e}();a(100);function O(e){var t=e.placeholder,a=e.content,n=e.caretPosition,r=e.syntaxError,o=e.isMarkDown,s=e.onContent,c=e.onEnter,l=e.onExecute,u=a.split("\n").length;return i.a.createElement("div",{className:"editorContainer"},r?i.a.createElement("p",{className:"editorError"},"".concat(r)):null,i.a.createElement("div",{className:"editor"},i.a.createElement(y,{placeholder:t,content:a,lines:u,caretPosition:n,onChange:function(e){var t=e.target.value,a=e.target.selectionEnd;t=t.replace(/\\/g,"\u03bb"),s(t,a)},onKeyDown:function(e){if(!e.shiftKey&&!e.ctrlKey&&"Enter"===e.key){if(o)return;e.preventDefault(),c()}e.shiftKey&&"Enter"===e.key&&o&&(e.preventDefault(),c()),e.ctrlKey&&"Enter"===e.key&&(e.preventDefault(),l())}})))}function y(e){var t=e.placeholder,a=e.content,n=e.lines,r=e.onChange,o=e.onKeyDown,s=e.caretPosition;return i.a.createElement("textarea",{className:"prompt",onKeyDown:o,onChange:r,value:a,placeholder:t,wrap:"hard",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,rows:Math.max(n,1),ref:function(e){null!==e&&(e.selectionStart=s,e.selectionEnd=s,e.focus())}})}!function(e){e.ENTER_EXPRESSION="Enter Expression",e.ENTER_EXERCISE="Enter Exercise",e.NEXT_STEP="Next Step",e.RUN="Run",e.ENTER_MD="Enter MarkDown"}(E||(E={}));var k=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.isActive,n=e.editor,r=(e.makeActive,n.placeholder),o=n.content,s=n.caretPosition,c=n.syntaxError;return i.a.createElement("div",{className:"".concat(t," ").concat(a?"":" inactiveBox"),onDoubleClick:this.props.makeActive},a?i.a.createElement(O,{placeholder:r,content:o,caretPosition:s,syntaxError:c,isMarkDown:!1,onContent:this.props.onContent,onEnter:this.props.onEnter,onExecute:this.props.onExecute}):i.a.createElement("p",{className:"inactiveMessage"},"Collapsing ",Math.max(0,this.props.history.length-1)," ",2===this.props.history.length?"step":"steps",". Double click to activate this box."))}}]),t}(n.PureComponent),j=(a(101),function(e){function t(e,a,n,i){var r;return Object(u.a)(this,t),(r=Object(d.a)(this,Object(p.a)(t).call(this))).tree=e,r.onClick=a,r.reduction=n,r.breakpoints=i,r.rendered=null,r.argument=null,r.tree.visit(Object(f.a)(Object(f.a)(r))),r}return Object(h.a)(t,e),Object(m.a)(t,[{key:"printMultiLambda",value:function(e,t){var a=this;if(e.body instanceof g.Lambda){var n=e.body.argument,r="argument";this.isBreakpoint(e.body.argument)&&(r+=" breakpoint");var o=!1;this.reduction instanceof g.Alpha&&Array.from(this.reduction.conversions).some(function(t){return t.identifier===e.body.identifier})&&(this.argument=n,o=!0);var s=this.argument;this.argument!==e.body.argument&&null!==this.argument&&this.argument.name()===e.body.argument.name()&&(this.argument=null),this.argument&&this.argument.name()===n.name()&&(r+=" substitutedArg");var c=i.a.createElement("span",{className:"arguments"},t," "," ",i.a.createElement("span",{className:r,onClick:function(){n.identifier=Symbol(),a.onClick({type:g.Beta,context:n,broken:new Set})}},n.name()));this.printMultiLambda(e.body,c),!0===o&&(this.argument=null),this.argument=s}else{e.body.visit(this);var l=this.rendered;this.rendered=t,this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda"},"\u03bb "," "),t," . ",l,")")}}},{key:"isBreakpoint",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=this.breakpoints[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){if(i.value.context.identifier===e.identifier)return!0}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}return!1}}]),Object(m.a)(t,[{key:"print",value:function(){return this.rendered}},{key:"onApplication",value:function(e){var t="left",a="right",n=!1,r=null;if(this.reduction instanceof g.Beta&&(r=this.reduction.redex),null!==r&&r.identifier===e.identifier&&r===e&&(t+=" redex",a+=" redex",e.left instanceof g.Lambda&&(this.argument=e.left.argument,n=!0)),e.right instanceof g.Application){e.left.visit(this);var o=i.a.createElement("span",{className:t},this.rendered);n&&(this.argument=null),e.right.visit(this);var s=i.a.createElement("span",{className:a},"( ",this.rendered," )");this.rendered=i.a.createElement("span",{className:"application"},o," ",s)}else{e.left.visit(this);var c=i.a.createElement("span",{className:t},this.rendered);n&&(this.argument=null),e.right.visit(this);var l=i.a.createElement("span",{className:a},this.rendered);this.rendered=i.a.createElement("span",{className:"application"},c," ",l)}}},{key:"onLambda",value:function(e){var t=this,a=this.argument;if(this.argument!==e.argument&&null!==this.argument&&this.argument.name()===e.argument.name()&&(this.argument=null),e.body instanceof g.Lambda){var n=e.argument,r="argument";this.isBreakpoint(e.argument)&&(r+=" breakpoint"),this.argument&&this.argument.name()===n.name()&&(r+=" substitutedArg");var o=i.a.createElement("span",{className:r,onClick:function(){n.identifier=Symbol(),t.onClick({type:g.Beta,context:n,broken:new Set})}},e.argument.name());this.printMultiLambda(e,o)}else{var s=e.argument;e.argument.visit(this);var c=this.rendered;e.body.visit(this);var l=this.rendered,u="argument";this.isBreakpoint(e.argument)&&(u+=" breakpoint"),this.rendered=i.a.createElement("span",{className:"function"},"(",i.a.createElement("span",{className:"lambda"},"\u03bb "," "),i.a.createElement("span",{className:u,onClick:function(){s.identifier=Symbol(),t.onClick({type:g.Beta,context:s,broken:new Set})}},c," "," "),". ",l,")")}null!==a&&(this.argument=a)}},{key:"onChurchNumeral",value:function(e){var t=this,a="churchnumeral",n=this.reduction instanceof g.Expansion?this.reduction.target:null;null!==n&&n.identifier===e.identifier&&n===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=i.a.createElement("span",{className:a,onClick:function(){e.identifier=Symbol(),t.onClick({type:g.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onMacro",value:function(e){var t=this,a="macro",n=this.reduction instanceof g.Expansion?this.reduction.target:null;null!==n&&n.identifier===e.identifier&&n===e&&(a+=" redex"),this.isBreakpoint(e)&&(a+=" breakpoint"),this.rendered=i.a.createElement("span",{className:a,onClick:function(){e.identifier=Symbol(),t.onClick({type:g.Expansion,context:e,broken:new Set})}},e.name())}},{key:"onVariable",value:function(e){var t="variable";this.argument&&this.argument.name()===e.name()&&(t+=" substitutedArg"),this.rendered=i.a.createElement("span",{className:t},e.name())}}]),t}(g.ASTVisitor)),I=a(30);function L(e){var t=e.lastReduction;return null===t?null:t instanceof g.Beta?i.a.createElement("p",{className:"lastReduction"},"\u03b2 reduction"):t instanceof g.Alpha?i.a.createElement("p",{className:"lastReduction"},"\u03b1 conversion"):t instanceof g.Expansion?i.a.createElement("p",{className:"lastReduction"},"Macro expansion"):t instanceof I.Eta?i.a.createElement("p",{className:"lastReduction"},"\u03b7 conversion"):null}var B=Object(n.memo)(function(e){var t=e.stepRecord,a=e.addBreakpoint,n=e.breakpoints,r=e.children,o=e.strategy,s=t.ast,c=t.lastReduction,l=t.step;t.message;if(null===s)return null;var u=new(T(o))(s).nextReduction,m=new j(s,a,u,n);return i.a.createElement("span",{className:"step"},i.a.createElement(L,{lastReduction:c}),i.a.createElement("div",{className:"inlineblock"},i.a.createElement("p",{className:"stepNumber"},l," :"),m.print(),r,""===t.message?null:i.a.createElement("p",{className:"stepMessage"},t.message)))},function(e){return!e.lastStep});var R=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.className;return i.a.createElement("div",{className:t+" inactiveBox",onDoubleClick:this.props.makeActive},i.a.createElement("ul",{className:"UL"},i.a.createElement("li",{key:0,className:"activeStep LI"},i.a.createElement(B,{breakpoints:this.props.breakpoints,addBreakpoint:function(){},stepRecord:this.props.history[0],strategy:this.props.globalStrategy,lastStep:!1},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.addBox(e.props.createBoxFrom(e.props.history[0]))}})))),i.a.createElement("p",{className:"inactiveMessage"},"Collapsing ",this.props.history.length-1," ",2===this.props.history.length?"step":"steps",". Double click to activate this box."))}}]),t}(n.PureComponent),A=(a(102),a(103),a(41)),C=A.Switch;A.Radio;function w(e){var t=e.isExercise,a=e.makeExercise,n=e.endExercise;return i.a.createElement("div",{id:"controls"},i.a.createElement("div",null,i.a.createElement(C,{className:"exerciseSwitch",checked:t,onChange:function(e){return e.target.checked?a():n()},shape:"fill"},"Exercise")))}var M=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.isExercise,r=t.state,o=t.editor,s=o.placeholder,c=o.content,u=o.caretPosition,m=o.syntaxError;return i.a.createElement("div",{className:a},i.a.createElement(w,{isExercise:n,makeExercise:function(){return e.props.setBoxState(Object(l.a)({},r,{isExercise:!0,editor:Object(l.a)({},r.editor,{placeholder:H.VALIDATE_MODE})}))},endExercise:function(){return e.props.setBoxState(Object(l.a)({},r,{isExercise:!1,editor:Object(l.a)({},r.editor,{placeholder:H.EVAL_MODE})}))}}),i.a.createElement("ul",{className:"UL"},function(e,t,a,n){for(var i=new Array(t-e+1),r=0,o=e;o<=t;++o)i[r++]=n(a[o],o);return i}(0,this.props.history.length-2,this.props.history,function(t,a){return i.a.createElement("li",{key:a.toString(),className:"inactiveStep LI"},i.a.createElement(B,{breakpoints:e.props.breakpoints,addBreakpoint:function(){},stepRecord:t,strategy:e.props.globalStrategy,lastStep:!1},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.addBox(e.props.createBoxFrom(t))}})))}),i.a.createElement("li",{key:this.props.history.length-1,className:"activeStep LI"},i.a.createElement(B,{breakpoints:this.props.breakpoints,addBreakpoint:this.addBreakpoint,stepRecord:this.props.history[this.props.history.length-1],strategy:this.props.globalStrategy,lastStep:!0},i.a.createElement("i",{className:"hiddenIcon fas fa-pencil-alt",onClick:function(){return e.props.addBox(e.props.createBoxFrom(e.props.history[e.props.history.length-1]))}})))),this.props.isNormalForm?null:i.a.createElement(O,{placeholder:s,content:c,caretPosition:u,syntaxError:m,isMarkDown:!1,onContent:this.props.onContent,onEnter:this.props.onEnter,onExecute:this.props.onExecute}))}},{key:"addBreakpoint",value:function(e){var t=this.props,a=t.state;(0,t.setBoxState)(Object(l.a)({},a,{breakpoints:[].concat(Object(c.a)(a.breakpoints),[e])}))}}]),t}(n.PureComponent);function T(e){switch(e){case z.NORMAL:return g.NormalEvaluator;case z.APPLICATIVE:return g.ApplicativeEvaluator;case z.OPTIMISATION:return g.OptimizeEvaluator}}var F=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).onContent=a.onContent.bind(Object(f.a)(Object(f.a)(a))),a.onSubmitExpression=a.onSubmitExpression.bind(Object(f.a)(Object(f.a)(a))),a.parseExpression=a.parseExpression.bind(Object(f.a)(Object(f.a)(a))),a.onEnter=a.onEnter.bind(Object(f.a)(Object(f.a)(a))),a.onExerciseStep=a.onExerciseStep.bind(Object(f.a)(Object(f.a)(a))),a.onStep=a.onStep.bind(Object(f.a)(Object(f.a)(a))),a.onExecute=a.onExecute.bind(Object(f.a)(Object(f.a)(a))),a.onRun=a.onRun.bind(Object(f.a)(Object(f.a)(a))),a.onStop=a.onStop.bind(Object(f.a)(Object(f.a)(a))),a.shouldBreak=a.shouldBreak.bind(Object(f.a)(Object(f.a)(a))),a.createBoxFrom=a.createBoxFrom.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.state,a=e.isActive,n=t.history,r=t.breakpoints,o=t.isExercise,s=(t.strategy,t.expression),c=t.editor,l="box boxEval",u=(n.length?n[n.length-1]:{isNormalForm:!1}).isNormalForm;return""===s?i.a.createElement(k,{className:l,isActive:this.props.isActive,editor:c,history:n,makeActive:this.props.makeActive,onContent:this.onContent,onEnter:this.onEnter,onExecute:this.onExecute}):(o&&(l+=" boxExercise"),a?i.a.createElement(M,{className:l,isExercise:o,state:t,breakpoints:r,history:n,globalStrategy:this.props.globalStrategy,editor:c,isNormalForm:u,addBox:this.props.addBox,createBoxFrom:this.createBoxFrom,setBoxState:this.props.setBoxState,onContent:this.onContent,onEnter:this.onEnter,onExecute:this.onExecute}):i.a.createElement(R,{className:l,breakpoints:r,history:n,globalStrategy:this.props.globalStrategy,makeActive:this.props.makeActive,addBox:this.props.addBox,createBoxFrom:this.createBoxFrom}))}},{key:"createBoxFrom",value:function(e){var t=this.props.state,a=t.strategy,n=t.singleLetterNames,i=e.ast;return{type:U.EXPRESSION,__key:Date.now().toString(),expression:i.toString(),ast:i.clone(),history:[{ast:i.clone(),lastReduction:null,step:0,message:"",isNormalForm:!1}],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:!1,strategy:a,singleLetterNames:n,editor:{placeholder:H.EVAL_MODE,content:"",caretPosition:0,syntaxError:null}}}},{key:"onContent",value:function(e,t){var a=this.props,n=a.state;(0,a.setBoxState)(Object(l.a)({},n,{editor:Object(l.a)({},n.editor,{content:e,caretPosition:t,syntaxError:null})}))}},{key:"onEnter",value:function(){var e=this.props.state,t=e.expression,a=e.isExercise,n=e.editor.content;""===t?this.onSubmitExpression():""!==n&&a?this.onExerciseStep():""!==n||a?console.log("Error: Something unexpected just happened. A"):this.onStep()}},{key:"onSubmitExpression",value:function(){var e=this.props,t=e.state,a=e.setBoxState,n=t.editor.content;try{var i=this.parseExpression(n);a(Object(l.a)({},t,{ast:i,expression:n,history:[{ast:i.clone(),lastReduction:g.None,step:0,message:"",isNormalForm:!1}],editor:{content:"",caretPosition:0,placeholder:H.EVAL_MODE,syntaxError:null}}))}catch(r){a(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:r.toString()})}))}}},{key:"onExerciseStep",value:function(){var e=this.props,t=e.state,a=e.setBoxState,n=t.strategy,i=t.history,r=t.editor.content;try{var o=this.parseExpression(r),s=i[i.length-1],u=s.isNormalForm,m=s.step,d=s.ast,p=s.lastReduction;if(d=d.clone(),u)return s.message="No more steps available. Expression is in normal form.",void a(Object(l.a)({},t));var h=new(T(n))(d);if(p=h.nextReduction,h.nextReduction instanceof g.None)return s.isNormalForm=!0,s.message="Expression is already in normal form.",void a(Object(l.a)({},t));d=h.perform();var f="";new S([o,d]).equals?(d=o,f="Correct."):(console.log("Incorrect step"),f="Incorrect step. ".concat(r)),a(Object(l.a)({},t,{history:[].concat(Object(c.a)(i),[{ast:d,lastReduction:p,step:m+1,message:f,isNormalForm:!1}]),editor:Object(l.a)({},t.editor,{content:"",caretPosition:0,placeholder:H.VALIDATE_MODE,syntaxError:null})}))}catch(b){}}},{key:"onStep",value:function(){var e=this.props,t=e.state,a=e.setBoxState,n=t.strategy,i=t.history,r=(t.editor.content,i[i.length-1]),o=r.isNormalForm,s=r.step,u=r.ast,m=r.lastReduction;if(u=u.clone(),!o){var d=new(T(n))(u);if(m=d.nextReduction,d.nextReduction instanceof g.None)return r.isNormalForm=!0,r.message="Expression is in normal form.",void a(Object(l.a)({},t));u=d.perform(),a(Object(l.a)({},t,{history:[].concat(Object(c.a)(i),[{ast:u,lastReduction:m,step:s+1,message:"",isNormalForm:!1}])}))}}},{key:"onExecute",value:function(){var e=this.props,t=e.state,a=e.setBoxState,n=t.isRunning;if(!t.isExercise)if(n)this.onStop();else{var i=t.timeout,r=t.history,o=r[r.length-1];if(o.isNormalForm)return;var s=o.ast,c=o.step,u=o.lastReduction,m=o.isNormalForm;o.message;r.push(r[r.length-1]),r[r.length-2]={ast:s.clone(),step:c,lastReduction:u,message:"Skipping some steps...",isNormalForm:m},a(Object(l.a)({},t,{isRunning:!0,timeoutID:window.setTimeout(this.onRun,i)}))}}},{key:"onRun",value:function(){var e=this,t=this.props,a=t.state,n=t.setBoxState,i=a.strategy,r=a.history,o=a.isRunning,s=a.breakpoints,c=a.timeoutID,u=a.timeout,m=r[r.length-1],d=m.isNormalForm,p=m.step,h=m.lastReduction;if(o)if(d)n(Object(l.a)({},a,{isRunning:!1,timeoutID:void 0}));else{var f=m.ast,b=new(T(i))(f);if(h=b.nextReduction,b.nextReduction instanceof g.None)return r.pop(),r.push({ast:f,lastReduction:m.lastReduction,step:p,message:"Expression is in normal form.",isNormalForm:!0}),void n(Object(l.a)({},a,{isRunning:!1,timeoutID:void 0}));var E=s.find(function(t){return e.shouldBreak(t,b.nextReduction)});if(void 0!==E)return b.nextReduction instanceof g.Expansion&&E.broken.add(b.nextReduction.target),b.nextReduction instanceof g.Beta&&b.nextReduction.redex.left instanceof g.Lambda&&E.broken.add(b.nextReduction.redex.left.argument),window.clearTimeout(c),void n(Object(l.a)({},a,{isRunning:!1,timeoutID:c}));f=b.perform(),r[r.length-1]={ast:f,lastReduction:h,step:p+1,message:"",isNormalForm:d},n(Object(l.a)({},a,{timeoutID:window.setTimeout(this.onRun,u)}))}}},{key:"onStop",value:function(){var e=this.props,t=e.state,a=e.setBoxState,n=t.timeoutID;window.clearTimeout(n),a(Object(l.a)({},t,{isRunning:!1,timeoutID:void 0}))}},{key:"shouldBreak",value:function(e,t){return t instanceof e.type&&t instanceof g.Beta&&e.context instanceof g.Variable&&t.redex.left instanceof g.Lambda&&t.redex.left.argument.identifier===e.context.identifier&&!e.broken.has(t.redex.left.argument)||(t instanceof e.type&&t instanceof g.Expansion&&e.context instanceof g.ChurchNumeral&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target)||t instanceof e.type&&t instanceof g.Expansion&&e.context instanceof g.Macro&&t.target.identifier===e.context.identifier&&!e.broken.has(t.target))}},{key:"parseExpression",value:function(e){var t=this.props.macroTable,a=this.props.state.singleLetterNames,n=Object(g.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(g.parse)(n,t)}}]),t}(n.PureComponent);function D(e){var t=e.state,a=e.setBoxState,n=e.defineMacro,r=t.macroName,o=t.macroExpression,s=t.singleLetterNames,c=t.editor,u=c.content,m=c.caretPosition,d=c.placeholder,p=c.syntaxError;return""===r&&""===o?i.a.createElement("div",{className:"box boxMacro inactiveBox"},i.a.createElement(O,{placeholder:d,content:u,caretPosition:m,syntaxError:p,isMarkDown:!1,onContent:function(t,n){a(Object(l.a)({},e.state,{editor:Object(l.a)({},e.state.editor,{content:t,caretPosition:n,syntaxError:null})}))},onEnter:function(){var e=u.split(":=").map(b),i=Object(x.a)(e,2),r=i[0],o=i[1];r in g.builtinMacros?a(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro name is not valid. It redefines built-in Macro.")})})):function(e,t){try{var a=P(e,t);return a instanceof g.Variable}catch(n){return!1}}(r,s)?function(e,t){try{return P(e,t),!0}catch(a){return!1}}(o,s)?(a(Object(l.a)({},t,{macroName:r,macroExpression:o})),n(r,o)):a(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro expression is not valid.")})})):a(Object(l.a)({},t,{editor:Object(l.a)({},t.editor,{syntaxError:new Error("Macro name is not valid.\n            ".concat(s&&1!==r.length?"Name should be single letter.":""))})}))},onExecute:function(){}})):i.a.createElement("div",{className:"box boxMacro"},r," := ",o)}function P(e,t){var a=t,n=Object(g.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(g.parse)(n,{})}a(187);var U,_=a(104);function Y(e){var t=e.state,a=t.note,n=t.editor,r=n.placeholder,o=n.content,s=n.caretPosition,c=n.syntaxError,u=t.isEditing,m=e.isActive,d=e.setBoxState,p=e.makeActive,h=function(){d(Object(l.a)({},e.state,{note:o,isEditing:!1}))};return u&&m?i.a.createElement("div",{className:"box boxNoteEditor"},i.a.createElement(O,{placeholder:r,content:o,caretPosition:s,syntaxError:c,isMarkDown:!0,onContent:function(t,a){d(Object(l.a)({},e.state,{editor:Object(l.a)({},e.state.editor,{content:t,caretPosition:a,syntaxError:null})}))},onEnter:h,onExecute:function(){}}),i.a.createElement("div",{id:"controls"},i.a.createElement("button",{onClick:function(){return h()}},"Save"))):i.a.createElement("div",{className:"box boxNote markdown-body"},i.a.createElement(_,{source:a}),i.a.createElement("div",{id:"controls"},i.a.createElement("button",{onClick:function(){d(Object(l.a)({},e.state,{isEditing:!0})),p()}},"Edit")))}function V(e){var t=e.state,a=e.isActive,n=e.macroTable,r=e.setBoxState,o=(e.makeActive,e.addBox),s=e.defineMacro,c=t.type;return c===U.EXPRESSION?i.a.createElement("div",{className:""},i.a.createElement(F,{state:t,globalStrategy:e.globalStrategy,isActive:a,macroTable:n,setBoxState:r,makeActive:e.makeActive,addBox:o})):c===U.MACRO?i.a.createElement("div",{className:""},i.a.createElement(D,{state:t,setBoxState:r,addBox:o,defineMacro:s})):c===U.NOTE?i.a.createElement("div",{className:""},i.a.createElement(Y,{state:t,isActive:a,setBoxState:r,makeActive:e.makeActive,addBox:o})):null}!function(e){e[e.EXPRESSION=0]="EXPRESSION",e[e.MACRO=1]="MACRO",e[e.NOTE=2]="NOTE"}(U||(U={}));a(188);function J(e){var t=e.state,a=e.onImport,n=e.onScreenChange,r=t.screen,o=function(e){return Object(l.a)({},e,{submittedBoxes:e.submittedBoxes.map(X)})}(t),s=function(e){var t=new Blob([e],{type:"application/json"});return window.URL.createObjectURL(t)}(JSON.stringify(o));return i.a.createElement("div",{id:"topbar"},i.a.createElement("div",null,r===G.main?i.a.createElement("i",{className:"icon fas fa-list-ul fa-2x",onClick:function(){return n(G.macrolist)}}):i.a.createElement("i",{className:"icon far fa-window-close fa-2x",onClick:function(){return n(G.main)}}),i.a.createElement("p",{className:"iconLabel"},"Macros")),i.a.createElement("div",null,i.a.createElement("a",{className:"export",href:s,download:"notebook_lambdulus.json",onClick:function(){return setTimeout(function(){return window.URL.revokeObjectURL(s)},10)}},i.a.createElement("i",{id:"download",className:"icon fas fa-cloud-download-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Export")),i.a.createElement("div",null,i.a.createElement("input",{type:"file",accept:"application/json",id:"input",onChange:function(e){return function(e,t){var a=e.target.files;if(null===a)return;var n=a[0],i=new FileReader;i.onload=function(e){var a=JSON.parse(i.result);t(function(e){var t=e.macroTable;return Object(l.a)({},e,{submittedBoxes:e.submittedBoxes.map(function(e){return function(e,t){if(e.type===U.EXPRESSION){var a=e,n=a.singleLetterNames,i=function(e,t){var a=t.singleLetterNames,n=t.macroTable,i=Object(g.tokenize)(e,{lambdaLetters:["\u03bb"],singleLetterVars:a});return Object(g.parse)(i,n)}(e.expression,{macroTable:t,singleLetterNames:n});return Object(l.a)({},e,{ast:i,history:[{ast:i,lastReduction:g.None,step:0,message:"",isNormalForm:!1}]})}return e}(e,t)})})}(a))},i.readAsText(n)}(e,a)}}),i.a.createElement("label",{htmlFor:"input"},i.a.createElement("i",{className:"icon fas fa-cloud-upload-alt fa-2x"})),i.a.createElement("p",{className:"iconLabel"},"Import")))}function X(e){return e.type===U.EXPRESSION?Object(l.a)({},e,{ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0}):e}function K(e){var t=e.globalStrategy,a=e.singleLetterNames,n=e.submittedBoxes,r=e.activeBoxIndex,o=e.macroTable,s=e.setBoxState,c=e.makeActive,l=e.addBox,u=e.defineMacro,m=i.a.createElement("div",{className:"emptyC"},i.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return e.addEmptyBox(function(e,t){return{type:U.EXPRESSION,__key:Date.now().toString(),expression:"",ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:!1,strategy:e,singleLetterNames:t,editor:{placeholder:H.INIT,content:"",caretPosition:0,syntaxError:null}}}(t,a))}},i.a.createElement("i",null,"+ \u03bb")),i.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return e.addEmptyBox(function(e){return{type:U.MACRO,__key:Date.now().toString(),macroName:"",macroExpression:"",singleLetterNames:e,editor:{placeholder:H.MACRO,content:"",caretPosition:0,syntaxError:null}}}(a))}},i.a.createElement("i",null,"+ Macro")),i.a.createElement("p",{className:"plusBtn inlineblock",onClick:function(){return e.addEmptyBox({type:U.NOTE,__key:Date.now().toString(),note:"",isEditing:!0,editor:{placeholder:H.NOTE,content:"",caretPosition:0,syntaxError:null}})}},i.a.createElement("i",null,"+ MD")));return 0===n.length?i.a.createElement("div",{className:"evaluatorSpace"},i.a.createElement("div",{className:"bigEmpty"},m)):i.a.createElement("div",{className:"evaluatorSpace"},i.a.createElement("ul",{className:"evaluatorList UL"},n.map(function(t,a){return i.a.createElement("li",{className:"LI",key:t.__key},i.a.createElement(V,{state:t,globalStrategy:e.globalStrategy,isActive:a===r,macroTable:o,setBoxState:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return s(a,e)}),makeActive:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return c(a)}),addBox:l,defineMacro:u}))}),i.a.createElement("div",{className:"smallEmpty"},m)))}function q(e){var t=e.macroTable,a=e.removeMacro;return i.a.createElement("div",{className:"macroSpace"},i.a.createElement("div",{className:"builtinMacros"},i.a.createElement("p",null,"Built-in Macros"),i.a.createElement("ul",{className:"UL"},Object.entries(g.builtinMacros).map(function(e){var t=Object(x.a)(e,2),a=t[0],n=t[1];return i.a.createElement("div",{key:a},i.a.createElement("li",{className:"LI"},i.a.createElement("div",{className:"box boxMacro"},a," := ",n)))}))),i.a.createElement("div",{className:"userMacros"},i.a.createElement("p",null,"User-defined Macros"),i.a.createElement("ul",null,Object.entries(t).map(function(e){var t=Object(x.a)(e,2),n=t[0],r=t[1];return i.a.createElement("div",{key:n},i.a.createElement("li",{className:"LI"},i.a.createElement("div",{className:"box boxMacro"},n," := ",r,i.a.createElement("i",{className:"hiddenMacroIcon far fa-trash-alt",onClick:function(){return a(n)}}))))}))))}var z,G,H,Q=a(41),W=Q.Switch,$=Q.Radio;!function(e){e.NORMAL="Normal Evaluation",e.APPLICATIVE="Applicative Evaluation",e.OPTIMISATION="Optimisation - \u03b7 Conversion"}(z||(z={})),function(e){e[e.main=0]="main",e[e.macrolist=1]="macrolist"}(G||(G={})),function(e){e.INIT="Type \u03bb expression and hit enter",e.EVAL_MODE="Hit enter for next step",e.VALIDATE_MODE="Write next step and hit enter for validation",e.MACRO="Define Macro like: `NAME := [\u03bb expression]` and hit enter",e.NOTE="Type note and hit shift enter"}(H||(H={}));var Z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).setBoxState=a.setBoxState.bind(Object(f.a)(Object(f.a)(a))),a.addEmptyBox=a.addEmptyBox.bind(Object(f.a)(Object(f.a)(a))),a.changeActiveBox=a.changeActiveBox.bind(Object(f.a)(Object(f.a)(a))),a.changeActiveStrategy=a.changeActiveStrategy.bind(Object(f.a)(Object(f.a)(a))),a.changeActiveSingleLetterNames=a.changeActiveSingleLetterNames.bind(Object(f.a)(Object(f.a)(a))),a.getActiveStrategy=a.getActiveStrategy.bind(Object(f.a)(Object(f.a)(a))),a.getActiveSingleLetterNames=a.getActiveSingleLetterNames.bind(Object(f.a)(Object(f.a)(a))),a.addBox=a.addBox.bind(Object(f.a)(Object(f.a)(a))),a.removeMacro=a.removeMacro.bind(Object(f.a)(Object(f.a)(a))),a.updateMacros=a.updateMacros.bind(Object(f.a)(Object(f.a)(a))),a.defineMacro=a.defineMacro.bind(Object(f.a)(Object(f.a)(a))),a.createBoxFromURL=a.createBoxFromURL.bind(Object(f.a)(Object(f.a)(a))),a.state={macroTable:Object(l.a)({},v,JSON.parse(window.localStorage.getItem("macrotable")||"{}")),submittedBoxes:[],screen:G.main,activeBoxIndex:-1},setTimeout(a.createBoxFromURL,1),window.addEventListener("hashchange",a.createBoxFromURL),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.macroTable,n=t.submittedBoxes,r=t.screen,o=t.activeBoxIndex;return i.a.createElement("div",{className:"app"},i.a.createElement(J,{state:this.state,onImport:function(t){return e.setState(t)},onScreenChange:function(t){return e.setState(Object(l.a)({},e.state,{screen:t}))}}),i.a.createElement("div",{className:"editorSettings"},i.a.createElement(W,{checked:this.getActiveSingleLetterNames(),disabled:!1,shape:"fill",onChange:function(t){return e.changeActiveSingleLetterNames(t.target.checked)}},"Single Letter Names"),i.a.createElement("div",{className:"strategies inlineblock"},i.a.createElement("p",{className:"stratsLabel inlineblock"},"Evaluation Strategies:"),i.a.createElement($,{name:"strategy",style:"fill",checked:this.getActiveStrategy()===z.NORMAL,onChange:function(){return e.changeActiveStrategy(z.NORMAL)}},"Normal"),i.a.createElement($,{style:"fill",name:"strategy",checked:this.getActiveStrategy()===z.APPLICATIVE,onChange:function(){return e.changeActiveStrategy(z.APPLICATIVE)}},"Applicative"))),r===G.main?i.a.createElement(K,{submittedBoxes:n,activeBoxIndex:o,globalStrategy:e.getActiveStrategy(),singleLetterNames:e.getActiveSingleLetterNames(),macroTable:a,makeActive:e.changeActiveBox,setBoxState:e.setBoxState,addEmptyBox:e.addEmptyBox,addBox:e.addBox,defineMacro:e.defineMacro}):i.a.createElement(q,{macroTable:a,removeMacro:e.removeMacro}))}},{key:"createBoxFromURL",value:function(){var e=decodeURI(window.location.hash.substring(1)),t=-1!==e.indexOf("exercise"),a=t?e.substring(8):e;if(""!==a){var n={type:U.EXPRESSION,__key:Date.now().toString(),expression:"",ast:null,history:[],isRunning:!1,breakpoints:[],timeoutID:void 0,timeout:10,isExercise:t,strategy:this.getActiveStrategy(),singleLetterNames:this.getActiveSingleLetterNames(),editor:{placeholder:H.INIT,content:a,caretPosition:a.length,syntaxError:null}};this.setState(Object(l.a)({},this.state,{submittedBoxes:[n],activeBoxIndex:0}))}}},{key:"setBoxState",value:function(e,t){var a=this.state,n=a.submittedBoxes,i=(a.activeBoxIndex,t.editor.content||t.expression),r=t.type===U.EXPRESSION&&t.isExercise?"exercise":"";history.pushState({},"page title?","#"+r+encodeURI(i)),n[e]=t,this.setState(Object(l.a)({},this.state,{submittedBoxes:n}))}},{key:"addEmptyBox",value:function(e){var t=this.state,a=t.submittedBoxes;t.activeBoxIndex;this.setState(Object(l.a)({},this.state,{submittedBoxes:[].concat(Object(c.a)(a),[e]),activeBoxIndex:Math.max(0,a.length)}))}},{key:"addBox",value:function(e){var t=this.state,a=t.submittedBoxes;t.activeBoxIndex;this.setState(Object(l.a)({},this.state,{submittedBoxes:[].concat(Object(c.a)(a),[e]),activeBoxIndex:a.length}))}},{key:"changeActiveBox",value:function(e){this.setState(Object(l.a)({},this.state,{activeBoxIndex:e}))}},{key:"getActiveStrategy",value:function(){var e=this.state,t=e.submittedBoxes,a=e.activeBoxIndex;if(-1===a)return JSON.parse(window.localStorage.getItem("strategy")||JSON.stringify(z.NORMAL));var n=t[a];return n.type!==U.EXPRESSION?JSON.parse(window.localStorage.getItem("strategy")||JSON.stringify(z.NORMAL)):n.strategy}},{key:"getActiveSingleLetterNames",value:function(){var e=this.state,t=e.submittedBoxes,a=e.activeBoxIndex;if(-1===a)return JSON.parse(window.localStorage.getItem("SLI")||"true");var n=t[a];return n.type===U.NOTE?JSON.parse(window.localStorage.getItem("SLI")||"true"):n.type===U.EXPRESSION?n.singleLetterNames:n.type===U.MACRO?n.singleLetterNames:JSON.parse(window.localStorage.getItem("SLI")||"true")}},{key:"changeActiveStrategy",value:function(e){var t=this.state,a=t.submittedBoxes,n=t.activeBoxIndex;a[n]=Object(l.a)({},a[n],{strategy:e}),this.setState(Object(l.a)({},this.state)),window.localStorage.setItem("strategy",JSON.stringify(e))}},{key:"changeActiveSingleLetterNames",value:function(e){var t=this.state,a=t.submittedBoxes,n=t.activeBoxIndex;a[n]=Object(l.a)({},a[n],{singleLetterNames:e}),this.setState(Object(l.a)({},this.state)),window.localStorage.setItem("SLI",JSON.stringify(e))}},{key:"removeMacro",value:function(e){var t=this.state.macroTable,a=Object(l.a)({},t);delete a[e],this.setState(Object(l.a)({},this.state,{macroTable:a})),this.updateMacros(a)}},{key:"updateMacros",value:function(e){window.localStorage.setItem("macrotable",JSON.stringify(e))}},{key:"defineMacro",value:function(e,t){var a=this.state.macroTable;this.setState(Object(l.a)({},this.state,{macroTable:Object(l.a)({},a,Object(s.a)({},e,t))})),this.updateMacros(Object(l.a)({},a,Object(s.a)({},e,t)))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},57:function(e,t,a){e.exports=a(189)},63:function(e,t,a){},64:function(e,t,a){},99:function(e,t,a){}},[[57,1,2]]]);
//# sourceMappingURL=main.6c498086.chunk.js.map